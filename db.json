{"meta":{"version":1,"warehouse":"1.0.3"},"models":{"Asset":[{"_id":"source/CNAME","path":"CNAME","modified":1},{"_id":"source/uploads/ipa组成.png","path":"uploads/ipa组成.png","modified":1},{"_id":"source/uploads/iOS证书和校验.png","path":"uploads/iOS证书和校验.png","modified":1},{"_id":"source/uploads/avatar.jpg","path":"uploads/avatar.jpg","modified":1},{"_id":"source/uploads/5.png","path":"uploads/5.png","modified":1},{"_id":"source/uploads/4.png","path":"uploads/4.png","modified":1},{"_id":"source/uploads/3.png","path":"uploads/3.png","modified":1},{"_id":"source/uploads/1451875469811263.png","path":"uploads/1451875469811263.png","modified":1},{"_id":"source/uploads/1451875454246244.png","path":"uploads/1451875454246244.png","modified":1},{"_id":"source/robots.txt","path":"robots.txt","modified":1},{"_id":"source/favicon.ico","path":"favicon.ico","modified":1},{"_id":"themes/next/source/vendors/velocity/velocity.ui.min.js","path":"vendors/velocity/velocity.ui.min.js","modified":1},{"_id":"themes/next/source/vendors/velocity/velocity.ui.js","path":"vendors/velocity/velocity.ui.js","modified":1},{"_id":"themes/next/source/vendors/velocity/velocity.min.js","path":"vendors/velocity/velocity.min.js","modified":1},{"_id":"themes/next/source/vendors/velocity/velocity.js","path":"vendors/velocity/velocity.js","modified":1},{"_id":"themes/next/source/vendors/velocity/bower.json","path":"vendors/velocity/bower.json","modified":1},{"_id":"themes/next/source/vendors/jquery_lazyload/jquery.scrollstop.js","path":"vendors/jquery_lazyload/jquery.scrollstop.js","modified":1},{"_id":"themes/next/source/vendors/jquery_lazyload/jquery.lazyload.js","path":"vendors/jquery_lazyload/jquery.lazyload.js","modified":1},{"_id":"themes/next/source/vendors/jquery_lazyload/bower.json","path":"vendors/jquery_lazyload/bower.json","modified":1},{"_id":"themes/next/source/vendors/jquery_lazyload/README.md","path":"vendors/jquery_lazyload/README.md","modified":1},{"_id":"themes/next/source/vendors/jquery_lazyload/CONTRIBUTING.md","path":"vendors/jquery_lazyload/CONTRIBUTING.md","modified":1},{"_id":"themes/next/source/vendors/jquery/index.js","path":"vendors/jquery/index.js","modified":1},{"_id":"themes/next/source/vendors/font-awesome/fonts/fontawesome-webfont.woff2","path":"vendors/font-awesome/fonts/fontawesome-webfont.woff2","modified":1},{"_id":"themes/next/source/vendors/font-awesome/fonts/fontawesome-webfont.woff","path":"vendors/font-awesome/fonts/fontawesome-webfont.woff","modified":1},{"_id":"themes/next/source/vendors/font-awesome/fonts/fontawesome-webfont.ttf","path":"vendors/font-awesome/fonts/fontawesome-webfont.ttf","modified":1},{"_id":"themes/next/source/vendors/font-awesome/fonts/fontawesome-webfont.svg","path":"vendors/font-awesome/fonts/fontawesome-webfont.svg","modified":1},{"_id":"themes/next/source/vendors/font-awesome/fonts/fontawesome-webfont.eot","path":"vendors/font-awesome/fonts/fontawesome-webfont.eot","modified":1},{"_id":"themes/next/source/vendors/font-awesome/fonts/FontAwesome.otf","path":"vendors/font-awesome/fonts/FontAwesome.otf","modified":1},{"_id":"themes/next/source/vendors/font-awesome/css/font-awesome.min.css","path":"vendors/font-awesome/css/font-awesome.min.css","modified":1},{"_id":"themes/next/source/vendors/font-awesome/css/font-awesome.css.map","path":"vendors/font-awesome/css/font-awesome.css.map","modified":1},{"_id":"themes/next/source/vendors/font-awesome/css/font-awesome.css","path":"vendors/font-awesome/css/font-awesome.css","modified":1},{"_id":"themes/next/source/vendors/font-awesome/bower.json","path":"vendors/font-awesome/bower.json","modified":1},{"_id":"themes/next/source/vendors/font-awesome/HELP-US-OUT.txt","path":"vendors/font-awesome/HELP-US-OUT.txt","modified":1},{"_id":"themes/next/source/vendors/fastclick/lib/fastclick.min.js","path":"vendors/fastclick/lib/fastclick.min.js","modified":1},{"_id":"themes/next/source/vendors/fastclick/lib/fastclick.js","path":"vendors/fastclick/lib/fastclick.js","modified":1},{"_id":"themes/next/source/vendors/fastclick/bower.json","path":"vendors/fastclick/bower.json","modified":1},{"_id":"themes/next/source/vendors/fastclick/README.md","path":"vendors/fastclick/README.md","modified":1},{"_id":"themes/next/source/vendors/fastclick/LICENSE","path":"vendors/fastclick/LICENSE","modified":1},{"_id":"themes/next/source/vendors/fancybox/source/jquery.fancybox.pack.js","path":"vendors/fancybox/source/jquery.fancybox.pack.js","modified":1},{"_id":"themes/next/source/vendors/fancybox/source/jquery.fancybox.js","path":"vendors/fancybox/source/jquery.fancybox.js","modified":1},{"_id":"themes/next/source/vendors/fancybox/source/jquery.fancybox.css","path":"vendors/fancybox/source/jquery.fancybox.css","modified":1},{"_id":"themes/next/source/vendors/fancybox/source/helpers/jquery.fancybox-thumbs.js","path":"vendors/fancybox/source/helpers/jquery.fancybox-thumbs.js","modified":1},{"_id":"themes/next/source/vendors/fancybox/source/helpers/jquery.fancybox-thumbs.css","path":"vendors/fancybox/source/helpers/jquery.fancybox-thumbs.css","modified":1},{"_id":"themes/next/source/vendors/fancybox/source/helpers/jquery.fancybox-media.js","path":"vendors/fancybox/source/helpers/jquery.fancybox-media.js","modified":1},{"_id":"themes/next/source/vendors/fancybox/source/helpers/jquery.fancybox-buttons.js","path":"vendors/fancybox/source/helpers/jquery.fancybox-buttons.js","modified":1},{"_id":"themes/next/source/vendors/fancybox/source/helpers/jquery.fancybox-buttons.css","path":"vendors/fancybox/source/helpers/jquery.fancybox-buttons.css","modified":1},{"_id":"themes/next/source/vendors/fancybox/source/helpers/fancybox_buttons.png","path":"vendors/fancybox/source/helpers/fancybox_buttons.png","modified":1},{"_id":"themes/next/source/vendors/fancybox/source/fancybox_sprite@2x.png","path":"vendors/fancybox/source/fancybox_sprite@2x.png","modified":1},{"_id":"themes/next/source/vendors/fancybox/source/fancybox_sprite.png","path":"vendors/fancybox/source/fancybox_sprite.png","modified":1},{"_id":"themes/next/source/vendors/fancybox/source/fancybox_overlay.png","path":"vendors/fancybox/source/fancybox_overlay.png","modified":1},{"_id":"themes/next/source/vendors/fancybox/source/fancybox_loading@2x.gif","path":"vendors/fancybox/source/fancybox_loading@2x.gif","modified":1},{"_id":"themes/next/source/vendors/fancybox/source/fancybox_loading.gif","path":"vendors/fancybox/source/fancybox_loading.gif","modified":1},{"_id":"themes/next/source/vendors/fancybox/source/blank.gif","path":"vendors/fancybox/source/blank.gif","modified":1},{"_id":"themes/next/source/js/ua-parser.min.js","path":"js/ua-parser.min.js","modified":1},{"_id":"themes/next/source/js/motion.js","path":"js/motion.js","modified":1},{"_id":"themes/next/source/js/hook-duoshuo.js","path":"js/hook-duoshuo.js","modified":1},{"_id":"themes/next/source/js/helpers.js","path":"js/helpers.js","modified":1},{"_id":"themes/next/source/js/fancy-box.js","path":"js/fancy-box.js","modified":1},{"_id":"themes/next/source/js/bootstrap.scrollspy.js","path":"js/bootstrap.scrollspy.js","modified":1},{"_id":"themes/next/source/js/bootstrap.js","path":"js/bootstrap.js","modified":1},{"_id":"themes/next/source/images/searchicon.png","path":"images/searchicon.png","modified":1},{"_id":"themes/next/source/images/quote-r.svg","path":"images/quote-r.svg","modified":1},{"_id":"themes/next/source/images/quote-l.svg","path":"images/quote-l.svg","modified":1},{"_id":"themes/next/source/images/placeholder.gif","path":"images/placeholder.gif","modified":1},{"_id":"themes/next/source/images/loading.gif","path":"images/loading.gif","modified":1},{"_id":"themes/next/source/images/cc-zero.svg","path":"images/cc-zero.svg","modified":1},{"_id":"themes/next/source/images/cc-by.svg","path":"images/cc-by.svg","modified":1},{"_id":"themes/next/source/images/cc-by-sa.svg","path":"images/cc-by-sa.svg","modified":1},{"_id":"themes/next/source/images/cc-by-nd.svg","path":"images/cc-by-nd.svg","modified":1},{"_id":"themes/next/source/images/cc-by-nc.svg","path":"images/cc-by-nc.svg","modified":1},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","path":"images/cc-by-nc-sa.svg","modified":1},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","path":"images/cc-by-nc-nd.svg","modified":1},{"_id":"themes/next/source/css/main.styl","path":"css/main.styl","modified":1}],"Cache":[{"_id":"source/CNAME","shasum":"09c89dc7fe1f8a30a8eeb4fadb822b636a9904d3","modified":1450404380000},{"_id":"source/_posts/First-blog.md","shasum":"1abbbb780158b49e91b218d10d798359276041df","modified":1450497107000},{"_id":"source/_posts/UIWindow-cannot-rotate.md","shasum":"92cde22e67965548374e4d45ab661be718e58070","modified":1452132480000},{"_id":"source/_posts/ios-certification-and-code-sign-note.md","shasum":"22b8bfe3fa2b64e2bb99e13db6e07c43ab4ed905","modified":1452857723000},{"_id":"source/_posts/ios-xia-opengl-xu-yao-zhu-yi-de-ji-dian.md","shasum":"f1a507e881eaf27883e14ea47a44d3fef3d46160","modified":1452133525000},{"_id":"source/_posts/sdwebimage-issues.md","shasum":"1dc1942afe29e943d88c53545e14704c7534c846","modified":1452132657000},{"_id":"source/about/index.md","shasum":"6d5d196549839fe354cf79f8375f3c3946996ee0","modified":1452094386000},{"_id":"source/categories/index.md","shasum":"91a185779f67033ddf956835d6710946ff6d454b","modified":1450496420000},{"_id":"source/favicon.ico","shasum":"fcd80082b0a7c604ef3a0152962ba12b81db0f66","modified":1450933119000},{"_id":"source/robots.txt","shasum":"f6a203139ca546f7e79aac0ee52a514407fccd96","modified":1451403482000},{"_id":"source/tags/index.md","shasum":"845041c9f7a77f28a2a85ede6b0b07aa1f896a76","modified":1450496463000},{"_id":"source/uploads/1451875454246244.png","shasum":"1adf4c5bf64d27bc7502562a29b01b26165eb787","modified":1452691052000},{"_id":"source/uploads/1451875469811263.png","shasum":"c0619592d295fc8219724c7f53637c716b5a90c2","modified":1452691062000},{"_id":"source/uploads/3.png","shasum":"822f0cd94e0759f9fffc316c5fe8d2e4a1ed653f","modified":1452174164000},{"_id":"source/uploads/4.png","shasum":"0c9fea79b42e0f907c1e0e362bfc6e5c50c98f7a","modified":1452174173000},{"_id":"source/uploads/5.png","shasum":"ae74ce6b6f9505f272d52a9ebbdb4b37b5f41d65","modified":1452823797000},{"_id":"source/uploads/ipa组成.png","shasum":"80e870def1a82264c780de615e2face9a1ecb78c","modified":1452850644000},{"_id":"source/uploads/iOS证书和校验.png","shasum":"e0414782b11e1ed321a569fe4c6227dd3461c2ab","modified":1452850633000},{"_id":"source/uploads/avatar.jpg","shasum":"b0fe2de3526735c077ba4828dbf95247d3de3606","modified":1450414056000},{"_id":"themes/next/source/css/_common/_page/home.styl","shasum":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1450405270000},{"_id":"themes/next/source/css/_mixins/Mist.styl","shasum":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1450405270000},{"_id":"themes/next/source/css/_mixins/custom.styl","shasum":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1450405270000},{"_id":"themes/next/source/css/_mixins/default.styl","shasum":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1450405270000},{"_id":"themes/next/source/css/_variables/custom.styl","shasum":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1450405270000},{"_id":"themes/next/README.en.md","shasum":"565ba52b3825b85a9f05b41183caca7f18b741d4","modified":1450405270000},{"_id":"themes/next/README.md","shasum":"0b709591995001cd860384d6c189e51d91690714","modified":1450405270000},{"_id":"themes/next/_config.yml","shasum":"503161d6ea23fc5a0d8c87b2c8d587ea2d65129a","modified":1452597003000},{"_id":"themes/next/bower.json","shasum":"4a53cab758c7d69be2ce773b2afff7dd962b7cb0","modified":1450405270000},{"_id":"themes/next/languages/de.yml","shasum":"7a8de0e5665c52a1bf168c1e7dd222c8a74fb0ab","modified":1450405270000},{"_id":"themes/next/languages/default.yml","shasum":"f57623e47f533c8d53d859628fa6a368a5298a00","modified":1450405270000},{"_id":"themes/next/languages/en.yml","shasum":"f57623e47f533c8d53d859628fa6a368a5298a00","modified":1450405270000},{"_id":"themes/next/languages/fr-FR.yml","shasum":"2cec663601ac8d178e97aee91d967fa99a95ad4e","modified":1450405270000},{"_id":"themes/next/languages/pt.yml","shasum":"8e38fdf3a5232b428d2e4a641666dbabab87c3d1","modified":1450405270000},{"_id":"themes/next/languages/ru.yml","shasum":"1d1b158f9cff1b38978086043f299b3fc590e007","modified":1450405270000},{"_id":"themes/next/languages/zh-Hans.yml","shasum":"c01d18d5c3837bb04d263e845db8f6827fde65de","modified":1450405270000},{"_id":"themes/next/languages/zh-hk.yml","shasum":"248b88c825fde8e35839f3954d38df4e72a0537c","modified":1450405270000},{"_id":"themes/next/languages/zh-tw.yml","shasum":"42ba1d0c6b6026ba1e613ad11efb75432a8132ac","modified":1450405270000},{"_id":"themes/next/layout/_layout.swig","shasum":"4efe52f310b797f4bdedacbd979caf285d2bc731","modified":1450405270000},{"_id":"themes/next/layout/_macro/post-collapse.swig","shasum":"9032ae9056cb19b4c2d069d66ead7abf828f9922","modified":1450405270000},{"_id":"themes/next/layout/_macro/post.swig","shasum":"f32eaace2afb0450cf230f96ee8c87f20d6a9072","modified":1450405270000},{"_id":"themes/next/layout/_macro/sidebar.swig","shasum":"88e179ff660874135b17d0febc91d04749053a73","modified":1450405270000},{"_id":"themes/next/layout/_partials/comments.swig","shasum":"a612a4eca51ffc87b53a5470b451071a7ad6a031","modified":1450405270000},{"_id":"themes/next/layout/_partials/duoshuo-hot-articles.swig","shasum":"5d4638c46aef65bf32a01681495b62416ccc98db","modified":1450405270000},{"_id":"themes/next/layout/_partials/footer.swig","shasum":"3cb6e03711d0d2faeea49d01c711545d3af3c3bb","modified":1452511239000},{"_id":"themes/next/layout/_partials/head.swig","shasum":"fcef099c268bd4964e65cfe3109e3fe99d0b925c","modified":1450405270000},{"_id":"themes/next/layout/_partials/header.swig","shasum":"476333c49a1e7e0402a68a826f67527ac258969d","modified":1450405270000},{"_id":"themes/next/layout/_partials/old-browsers.swig","shasum":"dbbfea810bf3a2ed9c83b9a6683037175aacfc67","modified":1450405270000},{"_id":"themes/next/layout/_partials/pagination.swig","shasum":"9e8e21d194ef44d271b1cca0bc1448c14d7edf4f","modified":1450405270000},{"_id":"themes/next/layout/_partials/search/swiftype.swig","shasum":"00c2b49f6289198b0b2b4e157e4ee783277f32a7","modified":1450405270000},{"_id":"themes/next/layout/_partials/search/tinysou.swig","shasum":"eefe2388ff3d424694045eda21346989b123977c","modified":1450405270000},{"_id":"themes/next/layout/_partials/search.swig","shasum":"64f14da26792a17bc27836c4e9d83190175f36e6","modified":1450405270000},{"_id":"themes/next/layout/_partials/share/duoshuo_share.swig","shasum":"89c5a5240ecb223acfe1d12377df5562a943fd5d","modified":1450405270000},{"_id":"themes/next/layout/_partials/share/jiathis.swig","shasum":"63315fcf210799f894208c9f512737096df84962","modified":1450405270000},{"_id":"themes/next/layout/_scripts/analytics/baidu-analytics.swig","shasum":"7c43d66da93cde65b473a7d6db2a86f9a42647d6","modified":1450405270000},{"_id":"themes/next/layout/_scripts/analytics/facebook-sdk.swig","shasum":"334176d838ee528e58468d8bc74ff3a6d3f25b2b","modified":1450405270000},{"_id":"themes/next/layout/_scripts/analytics/google-analytics.swig","shasum":"30a23fa7e816496fdec0e932aa42e2d13098a9c2","modified":1450405270000},{"_id":"themes/next/layout/_scripts/analytics.swig","shasum":"33ca06b9bd9a15a19432d5396b85bd319f017319","modified":1450405270000},{"_id":"themes/next/layout/_scripts/baidushare.swig","shasum":"d726361945437cf6e48067b3dd041b7e36e98d85","modified":1450405270000},{"_id":"themes/next/layout/_scripts/bootstrap.scrollspy.swig","shasum":"85295f126836b95f0837d03e58228bb3cf8c4490","modified":1450405270000},{"_id":"themes/next/layout/_scripts/comments/disqus.swig","shasum":"3491d3cebabc8a28857200db28a1be65aad6adc2","modified":1450405270000},{"_id":"themes/next/layout/_scripts/comments/duoshuo.swig","shasum":"44e3d567fd49c2a093f4a0a8af9f00542c935a58","modified":1450405270000},{"_id":"themes/next/layout/_scripts/fancy-box.swig","shasum":"41b4ff1446060c88c33bf666a32277dcf12129f0","modified":1450405270000},{"_id":"themes/next/layout/_scripts/helpers.swig","shasum":"4d2cbfca0aaf546a2b5813288073e824c1498fdf","modified":1450405270000},{"_id":"themes/next/layout/_scripts/mathjax.swig","shasum":"df03220eb8526e17dc9c9f17780c2d6699367181","modified":1450405270000},{"_id":"themes/next/layout/_scripts/motion.swig","shasum":"0d9761e3b1bb9e666ccc71bad59f035deb5a88c6","modified":1450405270000},{"_id":"themes/next/layout/_scripts/pages/post-details.swig","shasum":"7a34b02808f144ee4a11032ae3a149eb634a7e82","modified":1450405270000},{"_id":"themes/next/layout/_scripts/tinysou.swig","shasum":"cb3a5d36dbe1630bab84e03a52733a46df7c219b","modified":1450405270000},{"_id":"themes/next/layout/archive.swig","shasum":"0c3ce594759f347ea90a4ce592a7a18e2ae4cc5c","modified":1450405270000},{"_id":"themes/next/layout/category.swig","shasum":"d6b3e1dc5e0b8deade9a084c463126e70188ee9b","modified":1450405270000},{"_id":"themes/next/layout/index.swig","shasum":"38b1ad401b748965369296b86327d23082a1fe93","modified":1450405270000},{"_id":"themes/next/layout/page.swig","shasum":"8019d02232a6dd1a665b6a4d2daef8e5dd2f0049","modified":1450405270000},{"_id":"themes/next/layout/post.swig","shasum":"a84457e8ced46e63bc7a8a9e0541a6ba53122a92","modified":1450405270000},{"_id":"themes/next/layout/tag.swig","shasum":"aab44af54fcbc66fea4ad12b2767ffca3eadd451","modified":1450405270000},{"_id":"themes/next/scripts/filters/sticky.js","shasum":"6b1ea0c09105352813357d0fff4e1d3f4c821fa3","modified":1450405270000},{"_id":"themes/next/scripts/merge-configs.js","shasum":"0c56be2e85c694247cfa327ea6d627b99ca265e8","modified":1450405270000},{"_id":"themes/next/scripts/tags/center-quote.js","shasum":"535fc542781021c4326dec24d8495cbb1387634a","modified":1450405270000},{"_id":"themes/next/scripts/tags/full-image.js","shasum":"3acce36db0feb11a982c6c799aa6b6b47df2827c","modified":1450405270000},{"_id":"themes/next/scripts/tags/group-pictures.js","shasum":"49252824cd53184dc9b97b2f2d87ff28e1b3ef27","modified":1450405270000},{"_id":"themes/next/source/css/_common/_component/back-to-top.styl","shasum":"88cd66910260006aa8e9e795df4948d4b67bfa11","modified":1450405270000},{"_id":"themes/next/source/css/_common/_component/blockquote-center.styl","shasum":"c2abe4d87148e23e15d49ee225bc650de60baf46","modified":1450405270000},{"_id":"themes/next/source/css/_common/_component/buttons.styl","shasum":"81063e0979f04a0f9af37f321d7321dda9abf593","modified":1450405270000},{"_id":"themes/next/source/css/_common/_component/comments.styl","shasum":"471f1627891aca5c0e1973e09fbcb01e1510d193","modified":1450405270000},{"_id":"themes/next/source/css/_common/_component/gallery.styl","shasum":"387ce23bba52b22a586b2dfb4ec618fe1ffd3926","modified":1450405270000},{"_id":"themes/next/source/css/_common/_component/duoshuo.styl","shasum":"2d2da815ab0981b219ea1973a4aedede48801411","modified":1450405270000},{"_id":"themes/next/source/css/_common/_component/group-pictures.styl","shasum":"1ee40743000173495728855f734081eb2b6167cc","modified":1450405270000},{"_id":"themes/next/source/css/_common/_component/jiathis.styl","shasum":"327b5f63d55ec26f7663185c1a778440588d9803","modified":1450405270000},{"_id":"themes/next/source/css/_common/_component/pagination.styl","shasum":"711c8830886619d4f4a0598b0cde5499dce50c62","modified":1450405270000},{"_id":"themes/next/source/css/_common/_component/posts-collapse.styl","shasum":"6750b61236eb359028da8f2c4765f7c89b03dc9a","modified":1450405270000},{"_id":"themes/next/source/css/_common/_component/posts-expand.styl","shasum":"672d5fa7e5b7642d86a4bda176b501508b54860f","modified":1450405270000},{"_id":"themes/next/source/css/_common/_component/posts-type.styl","shasum":"40b593134bf96d1d6095b3439d47820659d7f10b","modified":1450405270000},{"_id":"themes/next/source/css/_common/_component/posts.styl","shasum":"b05ac51dd266d27f12e39e59a94383fe6474b7b3","modified":1450405270000},{"_id":"themes/next/source/css/_common/_component/tag-cloud.styl","shasum":"dd8a3b22fc2f222ac6e6c05bd8a773fb039169c0","modified":1450405270000},{"_id":"themes/next/source/css/_common/_core/base.styl","shasum":"388aa7c69c97728c64941db01e0f29a88837120c","modified":1450405270000},{"_id":"themes/next/source/css/_common/_core/helpers.styl","shasum":"d339d114e52a9abbc797ec236a8a770c29e288a6","modified":1450405270000},{"_id":"themes/next/source/css/_common/_core/normalize.styl","shasum":"ece571f38180febaf02ace8187ead8318a300ea7","modified":1450405270000},{"_id":"themes/next/source/css/_common/_core/scaffolding.styl","shasum":"1f8acb3331300eec696a09e7859e11f191e16d7f","modified":1450405270000},{"_id":"themes/next/source/css/_common/_core/tables.styl","shasum":"5f766cf26f966dbf9dcfe681f40ab9032e3e8a08","modified":1450405270000},{"_id":"themes/next/source/css/_common/_fonts/icon-default.styl","shasum":"8b809aef383bebaeb3f282b47675f3a364ce3569","modified":1450405270000},{"_id":"themes/next/source/css/_common/_fonts/icon-feather.styl","shasum":"80413afacfa656322100ce1900fed1ebcd8f8f44","modified":1450405270000},{"_id":"themes/next/source/css/_common/_fonts/icon-fifty-shades.styl","shasum":"249f75bafa26b99d272352c0646e7497ea680b39","modified":1450405270000},{"_id":"themes/next/source/css/_common/_fonts/icon-font.styl","shasum":"ec3f86739bede393cafcd3e31052c01115ae20d6","modified":1450405270000},{"_id":"themes/next/source/css/_common/_fonts/icon-linecons.styl","shasum":"9cdbedb3627ac941cfb063b152abe5a75c3c699a","modified":1450405270000},{"_id":"themes/next/source/css/_common/_page/archive.styl","shasum":"dff879f55ca65fa79c07e9098719e53eeea7ac88","modified":1450405270000},{"_id":"themes/next/source/css/_common/_page/categories.styl","shasum":"4f696a2eaeee2f214adcf273eab25c62a398077a","modified":1450405270000},{"_id":"themes/next/source/css/_common/_page/post-detail.styl","shasum":"9bf4362a4d0ae151ada84b219d39fbe5bb8c790e","modified":1450405270000},{"_id":"themes/next/source/css/_common/_section/body.styl","shasum":"ca1a4766cbe25baac757c6b47a4858d221afdc40","modified":1450405270000},{"_id":"themes/next/source/css/_common/_section/footer.styl","shasum":"8994ffcce84deac0471532f270f97c44fea54dc0","modified":1450405270000},{"_id":"themes/next/source/css/_common/_section/header.styl","shasum":"a6aa8a56f9f645ae5a76a1034f79adf73b053aa0","modified":1450405270000},{"_id":"themes/next/source/css/_common/_section/layout.styl","shasum":"03ae7b808dde9065412968aa69916162e790455d","modified":1450405270000},{"_id":"themes/next/source/css/_common/_section/media.styl","shasum":"fa9809d2ecc753cf32f70803c1d0821c405211f4","modified":1450405270000},{"_id":"themes/next/source/css/_common/_section/sidebar.styl","shasum":"bc106c3e759cd752c2b4c53ac27bc5ef5e3b18ea","modified":1450405270000},{"_id":"themes/next/source/css/_common/_vendor/highlight/highlight.styl","shasum":"6242be4307a3b3dafc14e556f51c8875c41a1ddd","modified":1450405270000},{"_id":"themes/next/source/css/_common/_vendor/highlight/theme.styl","shasum":"ae19721ceee5ba460e131cb2427dae3c1ff39d6f","modified":1450405270000},{"_id":"themes/next/source/css/_custom/custom.styl","shasum":"328d9a9696cc2ccf59c67d3c26000d569f46344c","modified":1450405270000},{"_id":"themes/next/source/css/_mixins/base.styl","shasum":"4e49707c99c8bbcfa0a607dfdaff0fbb7dffd2a3","modified":1450405270000},{"_id":"themes/next/source/css/_schemes/Mist/_base.styl","shasum":"d50c2a9ae363d26ed2e9bc226a9dc7abeb9ace1b","modified":1450405270000},{"_id":"themes/next/source/css/_schemes/Mist/_header.styl","shasum":"1631a430655eadb485574d1a9bedd49460988b11","modified":1450405270000},{"_id":"themes/next/source/css/_schemes/Mist/_logo.styl","shasum":"38e5df90c8689a71c978fd83ba74af3d4e4e5386","modified":1450405270000},{"_id":"themes/next/source/css/_schemes/Mist/_menu.styl","shasum":"5a8036fc61207ca0fe38c9782ed2f686fbf764be","modified":1450405270000},{"_id":"themes/next/source/css/_schemes/Mist/_posts-expanded.styl","shasum":"4303776991ef28f5742ca51c7dffe6f12f0acf34","modified":1450405270000},{"_id":"themes/next/source/css/_schemes/Mist/index.styl","shasum":"fc7d96b897290dbd93bc8c515a2058fc4c374ea7","modified":1450405270000},{"_id":"themes/next/source/css/_schemes/default/_logo.styl","shasum":"8829bc556ca38bfec4add4f15a2f028092ac6d46","modified":1450405270000},{"_id":"themes/next/source/css/_schemes/default/_menu.styl","shasum":"4bba29cece65ffc5122f4e052063dea4439fe4ae","modified":1450405270000},{"_id":"themes/next/source/css/_schemes/default/_search.styl","shasum":"c524bccdc554349106d1c8be9c3f275d4c0d4281","modified":1450405270000},{"_id":"themes/next/source/css/_schemes/default/index.styl","shasum":"159464cb8a7e01e32db9ec70dec391ec70a72f9c","modified":1450405270000},{"_id":"themes/next/source/css/_variables/Mist.styl","shasum":"9f8791860cc1ca724d2dfe609e8cd6abc44d6926","modified":1450405270000},{"_id":"themes/next/source/css/_variables/base.styl","shasum":"f532d6b0f961a8f3867c06e132233286f110180d","modified":1450405270000},{"_id":"themes/next/source/css/_variables/default.styl","shasum":"8ec3307fe42d738b1bbda4b6419d0995f5560222","modified":1450405270000},{"_id":"themes/next/source/css/main.styl","shasum":"56dacee56c5eaa4b2676d196452314fb50f758aa","modified":1450405270000},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","shasum":"c6524ece3f8039a5f612feaf865d21ec8a794564","modified":1450405270000},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","shasum":"3031be41e8753c70508aa88e84ed8f4f653f157e","modified":1450405270000},{"_id":"themes/next/source/images/cc-by-nc.svg","shasum":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7","modified":1450405270000},{"_id":"themes/next/source/images/cc-by-nd.svg","shasum":"c563508ce9ced1e66948024ba1153400ac0e0621","modified":1450405270000},{"_id":"themes/next/source/images/cc-by-sa.svg","shasum":"aa4742d733c8af8d38d4c183b8adbdcab045872e","modified":1450405270000},{"_id":"themes/next/source/images/cc-by.svg","shasum":"28a0a4fe355a974a5e42f68031652b76798d4f7e","modified":1450405270000},{"_id":"themes/next/source/images/cc-zero.svg","shasum":"87669bf8ac268a91d027a0a4802c92a1473e9030","modified":1450405270000},{"_id":"themes/next/source/images/placeholder.gif","shasum":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1450405270000},{"_id":"themes/next/source/images/loading.gif","shasum":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1450405270000},{"_id":"themes/next/source/images/quote-l.svg","shasum":"94e870b4c8c48da61d09522196d4dd40e277a98f","modified":1450405270000},{"_id":"themes/next/source/images/quote-r.svg","shasum":"e60ae504f9d99b712c793c3740c6b100d057d4ec","modified":1450405270000},{"_id":"themes/next/source/images/searchicon.png","shasum":"67727a6a969be0b2659b908518fa6706eed307b8","modified":1450405270000},{"_id":"themes/next/source/js/bootstrap.js","shasum":"f9b637b6d064f728d7dc2b6b5058a006a4454299","modified":1450405270000},{"_id":"themes/next/source/js/bootstrap.scrollspy.js","shasum":"ae7bdce88b515aade4eea8bf7407eec458bcd625","modified":1450405270000},{"_id":"themes/next/source/js/fancy-box.js","shasum":"b5fa638ed371b5f658b0826ec4afee25d9986ef2","modified":1450405270000},{"_id":"themes/next/source/js/helpers.js","shasum":"c15216ef897334362789ba37464298948b2eef95","modified":1450405270000},{"_id":"themes/next/source/js/hook-duoshuo.js","shasum":"ccb32e0a1acf798337c9697e1aab5484b52f9df4","modified":1450405270000},{"_id":"themes/next/source/js/motion.js","shasum":"b4132517fe499538ad725094593fb7ead8c04bf7","modified":1450405270000},{"_id":"themes/next/source/js/ua-parser.min.js","shasum":"1148fa2bcb8b2e40c31e5f597bf794a57369a2e6","modified":1450405270000},{"_id":"themes/next/source/vendors/fancybox/source/blank.gif","shasum":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1450405270000},{"_id":"themes/next/source/vendors/fancybox/source/fancybox_loading.gif","shasum":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1450405270000},{"_id":"themes/next/source/vendors/fancybox/source/fancybox_overlay.png","shasum":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1450405270000},{"_id":"themes/next/source/vendors/fancybox/source/fancybox_sprite.png","shasum":"17df19f97628e77be09c352bf27425faea248251","modified":1450405270000},{"_id":"themes/next/source/vendors/fancybox/source/fancybox_loading@2x.gif","shasum":"273b123496a42ba45c3416adb027cd99745058b0","modified":1450405270000},{"_id":"themes/next/source/vendors/fancybox/source/fancybox_sprite@2x.png","shasum":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1450405270000},{"_id":"themes/next/source/vendors/fancybox/source/helpers/fancybox_buttons.png","shasum":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1450405270000},{"_id":"themes/next/source/vendors/fancybox/source/helpers/jquery.fancybox-buttons.css","shasum":"1a9d8e5c22b371fcc69d4dbbb823d9c39f04c0c8","modified":1450405270000},{"_id":"themes/next/source/vendors/fancybox/source/helpers/jquery.fancybox-buttons.js","shasum":"91e41741c2e93f732c82aaacec4cfc6e3f3ec876","modified":1450405270000},{"_id":"themes/next/source/vendors/fancybox/source/helpers/jquery.fancybox-media.js","shasum":"3bdf69ed2469e4fb57f5a95f17300eef891ff90d","modified":1450405270000},{"_id":"themes/next/source/vendors/fancybox/source/helpers/jquery.fancybox-thumbs.css","shasum":"4ac329c16a5277592fc12a37cca3d72ca4ec292f","modified":1450405270000},{"_id":"themes/next/source/vendors/fancybox/source/helpers/jquery.fancybox-thumbs.js","shasum":"53e194f4a72e649c04fb586dd57762b8c022800b","modified":1450405270000},{"_id":"themes/next/source/vendors/fancybox/source/jquery.fancybox.css","shasum":"5f163444617b6cf267342f06ac166a237bb62df9","modified":1450405270000},{"_id":"themes/next/source/vendors/fastclick/LICENSE","shasum":"dcd5b6b43095d9e90353a28b09cb269de8d4838e","modified":1450405270000},{"_id":"themes/next/source/vendors/fancybox/source/jquery.fancybox.pack.js","shasum":"53360764b429c212f424399384417ccc233bb3be","modified":1450405270000},{"_id":"themes/next/source/vendors/fancybox/source/jquery.fancybox.js","shasum":"1cf3d47b5ccb7cb6e9019c64f2a88d03a64853e4","modified":1450405270000},{"_id":"themes/next/source/vendors/fastclick/README.md","shasum":"1decd8e1adad2cd6db0ab50cf56de6035156f4ea","modified":1450405270000},{"_id":"themes/next/source/vendors/fastclick/bower.json","shasum":"13379463c7463b4b96d13556b46faa4cc38d81e6","modified":1450405270000},{"_id":"themes/next/source/vendors/fastclick/lib/fastclick.min.js","shasum":"2cae0f5a6c5d6f3cb993015e6863f9483fc4de18","modified":1450405270000},{"_id":"themes/next/source/vendors/fastclick/lib/fastclick.js","shasum":"06cef196733a710e77ad7e386ced6963f092dc55","modified":1450405270000},{"_id":"themes/next/source/vendors/font-awesome/HELP-US-OUT.txt","shasum":"69a4c537d167b68a0ccf1c6febd138aeffca60d6","modified":1450405270000},{"_id":"themes/next/source/vendors/font-awesome/bower.json","shasum":"279a8a718ab6c930a67c41237f0aac166c1b9440","modified":1450405270000},{"_id":"themes/next/source/vendors/font-awesome/css/font-awesome.css","shasum":"3b87c2560832748cd06f9bfd2fd6ea8edbdae8c7","modified":1450405270000},{"_id":"themes/next/source/vendors/font-awesome/css/font-awesome.css.map","shasum":"0189d278706509412bac4745f96c83984e1d59f4","modified":1450405270000},{"_id":"themes/next/source/vendors/font-awesome/css/font-awesome.min.css","shasum":"05ea25bc9b3ac48993e1fee322d3bc94b49a6e22","modified":1450405270000},{"_id":"themes/next/source/vendors/font-awesome/fonts/fontawesome-webfont.woff2","shasum":"574ea2698c03ae9477db2ea3baf460ee32f1a7ea","modified":1450405270000},{"_id":"themes/next/source/vendors/jquery_lazyload/CONTRIBUTING.md","shasum":"4891864c24c28efecd81a6a8d3f261145190f901","modified":1450405270000},{"_id":"themes/next/source/vendors/jquery_lazyload/README.md","shasum":"895d50fa29759af7835256522e9dd7dac597765c","modified":1450405270000},{"_id":"themes/next/source/vendors/jquery_lazyload/bower.json","shasum":"65bc85d12197e71c40a55c0cd7f6823995a05222","modified":1450405270000},{"_id":"themes/next/source/vendors/jquery_lazyload/jquery.lazyload.js","shasum":"481fd478650e12b67c201a0ea41e92743f8b45a3","modified":1450405270000},{"_id":"themes/next/source/vendors/jquery_lazyload/jquery.scrollstop.js","shasum":"0e9a81785a011c98be5ea821a8ed7d411818cfd1","modified":1450405270000},{"_id":"themes/next/source/vendors/velocity/bower.json","shasum":"2ec99573e84c7117368beccb9e94b6bf35d2db03","modified":1450405270000},{"_id":"themes/next/source/vendors/velocity/velocity.min.js","shasum":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1450405270000},{"_id":"themes/next/source/vendors/velocity/velocity.ui.min.js","shasum":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1450405270000},{"_id":"themes/next/test/helpers.js","shasum":"a1f5de25154c3724ffc24a91ddc576cdbd60864f","modified":1450405270000},{"_id":"themes/next/source/vendors/velocity/velocity.ui.js","shasum":"6a1d101eab3de87527bb54fcc8c7b36b79d8f0df","modified":1450405270000},{"_id":"themes/next/test/intern.js","shasum":"11fa8a4f5c3b4119a179ae0a2584c8187f907a73","modified":1450405270000},{"_id":"themes/next/source/vendors/font-awesome/fonts/FontAwesome.otf","shasum":"0112e96f327d413938d37c1693806f468ffdbace","modified":1450405270000},{"_id":"themes/next/source/vendors/font-awesome/fonts/fontawesome-webfont.eot","shasum":"b3c2f08e73320135b69c23a3908b87a12053a2f6","modified":1450405270000},{"_id":"themes/next/source/vendors/font-awesome/fonts/fontawesome-webfont.woff","shasum":"507970402e328b2baeb05bde73bf9ded4e2c3a2d","modified":1450405270000},{"_id":"themes/next/source/vendors/jquery/index.js","shasum":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1450405270000},{"_id":"themes/next/source/vendors/font-awesome/fonts/fontawesome-webfont.ttf","shasum":"27cf1f2ec59aece6938c7bb2feb0e287ea778ff9","modified":1450405270000},{"_id":"themes/next/source/vendors/velocity/velocity.js","shasum":"e63dc7cea055ca60a95d286f32349d88b10c5a4d","modified":1450405270000},{"_id":"themes/next/source/vendors/font-awesome/fonts/fontawesome-webfont.svg","shasum":"2b3c8ba7008cc014d8fb37abc6f9f49aeda83824","modified":1450405270000}],"Category":[{"name":"开发笔记","_id":"cijflzuv800045m8denoh1sx3"},{"name":"学习笔记","_id":"cijflzuvl000j5m8dl00ejuvb"},{"name":"default","_id":"cijflzuvs00115m8dktqi9lx3"}],"Data":[],"Page":[{"title":"tags","date":"2015-12-18T04:52:01.000Z","type":"tags","comments":0,"_content":"","source":"tags/index.md","raw":"title: tags\ndate: 2015-12-18 12:52:01\ntype: \"tags\"\ncomments: false\n---\n","updated":"2015-12-19T03:41:03.000Z","path":"tags/index.html","layout":"page","_id":"cijflzuue00005m8djmewhiar"},{"title":"categories","date":"2015-12-19T03:38:59.000Z","type":"categories","comments":0,"_content":"","source":"categories/index.md","raw":"title: categories\ndate: 2015-12-19 11:38:59\ntype: \"categories\"\ncomments: false\n---\n","updated":"2015-12-19T03:40:20.000Z","path":"categories/index.html","layout":"page","_id":"cijflzuuj00015m8dn9a19o8y"},{"title":"about","date":"2015-12-18T04:50:16.000Z","comments":0,"_content":"\n## 关于Enki\n\n嗨，我是Enki，一名来自广州的iOS开发者。目前就职于CVTE，一名崇尚自由的白羊座Boy。  \n喜欢音乐、旅行、摄影、吉他、户外徒步还有篮球，对了还有游戏。\n\n> 自由自在地思想，自由自在地瞎想，  \n> 自由自在地少想，自由自在地选择我自己的生活，选择我自身。  \n> 　　　　　　　　　　　　　　　　　　　by 弗朗索瓦丝·萨冈\n\n## 我的联系方式\n`email:` xc120313778#163.com  \n`github:` https://github.com/EnkiChen","source":"about/index.md","raw":"title: about\ndate: 2015-12-18 12:50:16\ncomments: false\n---\n\n## 关于Enki\n\n嗨，我是Enki，一名来自广州的iOS开发者。目前就职于CVTE，一名崇尚自由的白羊座Boy。  \n喜欢音乐、旅行、摄影、吉他、户外徒步还有篮球，对了还有游戏。\n\n> 自由自在地思想，自由自在地瞎想，  \n> 自由自在地少想，自由自在地选择我自己的生活，选择我自身。  \n> 　　　　　　　　　　　　　　　　　　　by 弗朗索瓦丝·萨冈\n\n## 我的联系方式\n`email:` xc120313778#163.com  \n`github:` https://github.com/EnkiChen","updated":"2016-01-06T15:33:06.000Z","path":"about/index.html","layout":"page","_id":"cijflzuv000025m8dyx05jmmc"}],"Post":[{"title":"优化APP时发现的SDWebImage的问题","date":"2015-12-22T11:34:17.000Z","_content":"### 起因 旋转了的图片\n前段时间在对程序的绘图逻辑进行了使用OpenGL做优化，但是在使用OpenGL进行绘制时发现一些图片会莫名其妙的旋转，在细看了代码之后发现问题发生在**UIImage**对象的**imageOrientation**属性。该属性为枚举类型可以有以下取值：  \n<!--more-->\n\n```\ntypedef enum {\n    UIImageOrientationUp,            // default orientation  默认方向   \n    UIImageOrientationDown,          // 180 deg rotation     旋转180度    \n    UIImageOrientationLeft,          // 90 deg CCW           逆时针旋转90度\n    UIImageOrientationRight,         // 90 deg CW            顺时针旋转90度\n    UIImageOrientationUpMirrored,    // horizontal flip      向上水平翻转\n    UIImageOrientationDownMirrored,  // horizontal flip      向下水平翻转\n    UIImageOrientationLeftMirrored,  // vertical flip        逆时针旋转90度，垂直翻转\n    UIImageOrientationRightMirrored, // vertical flip        顺时针旋转90度，垂直翻转\n} UIImageOrientation;\n```\n\n该属性用来记录照片的方向信息，在使用iPhone或者iPad自带的照相机拍摄出来的照片含有EXIF信息，而在使用Core Graphics进行绘制时，会进行一些转换，我在使用OpenGL绘制时直接使用的原图，转换成纹理对象时是旋转的图片对象，所以在使用OpenGL绘制会出现旋转问题。在网上找了一下代码做了调整：\n\n```\n- (UIImage *)fixOrientation{\n    \n    // No-op if the orientation is already correct\n    if (self.imageOrientation == UIImageOrientationUp)\n        return self;\n    \n    // We need to calculate the proper transformation to make the image upright.\n    // We do it in 2 steps: Rotate if Left/Right/Down, and then flip if Mirrored.\n    CGAffineTransform transform = CGAffineTransformIdentity;\n    \n    switch (self.imageOrientation) {\n        case UIImageOrientationDown:\n        case UIImageOrientationDownMirrored:\n            transform = CGAffineTransformTranslate(transform, self.size.width, self.size.height);\n            transform = CGAffineTransformRotate(transform, M_PI);\n            break;\n            \n        case UIImageOrientationLeft:\n        case UIImageOrientationLeftMirrored:\n            transform = CGAffineTransformTranslate(transform, self.size.width, 0);\n            transform = CGAffineTransformRotate(transform, M_PI_2);\n            break;\n            \n        case UIImageOrientationRight:\n        case UIImageOrientationRightMirrored:\n            transform = CGAffineTransformTranslate(transform, 0, self.size.height);\n            transform = CGAffineTransformRotate(transform, -M_PI_2);\n            break;\n        default:\n            break;\n    }\n    \n    switch (self.imageOrientation) {\n        case UIImageOrientationUpMirrored:\n        case UIImageOrientationDownMirrored:\n            transform = CGAffineTransformTranslate(transform, self.size.width, 0);\n            transform = CGAffineTransformScale(transform, -1, 1);\n            break;\n            \n        case UIImageOrientationLeftMirrored:\n        case UIImageOrientationRightMirrored:\n            transform = CGAffineTransformTranslate(transform, self.size.height, 0);\n            transform = CGAffineTransformScale(transform, -1, 1);\n            break;\n        default:\n            break;\n    }\n    \n    // Now we draw the underlying CGImage into a new context, applying the transform\n    // calculated above.\n    CGContextRef ctx = CGBitmapContextCreate(NULL, self.size.width, self.size.height,\n                                             CGImageGetBitsPerComponent(self.CGImage), 0,\n                                             CGImageGetColorSpace(self.CGImage),\n                                             CGImageGetBitmapInfo(self.CGImage));\n    CGContextConcatCTM(ctx, transform);\n    switch (self.imageOrientation) {\n        case UIImageOrientationLeft:\n        case UIImageOrientationLeftMirrored:\n        case UIImageOrientationRight:\n        case UIImageOrientationRightMirrored:\n            // Grr...\n            CGContextDrawImage(ctx, CGRectMake(0,0,self.size.height,self.size.width), self.CGImage);\n            break;\n            \n        default:\n            CGContextDrawImage(ctx, CGRectMake(0,0,self.size.width,self.size.height), self.CGImage);\n            break;\n    }\n    \n    // And now we just create a new UIImage from the drawing context\n    CGImageRef cgimg = CGBitmapContextCreateImage(ctx);\n    UIImage *img = [UIImage imageWithCGImage:cgimg];\n    CGContextRelease(ctx);\n    CGImageRelease(cgimg);\n    return img;\n}\n```\n### 再次遇到旋转问题\n\n旋转问题得到解决之后，使用了**SDWebImage**自带的**SDImageCache**类进行了图片的缓存管理，该类能够做到内存不足时释放不需要的图片对象。类底层使用了系统的**NSCache**实现的，能够在系统内存不足时释放被管理的对象。   \n\n在使用**SDImageCache**类做缓存之后，我们的测试MM发现在一些情况下会出现图片旋转的问题。而且是 Core Graphics 和 OpenGL 两个环境下都会出现。因为有了前面的经验，很快就找到了方向，那就是**UIImage**对象的**imageOrientation**属性出问题了，经过一步步调试发现，在**UIImage**对象交给**SDImageCache**管理之后，再从缓存中拿出来时**imageOrientation**属性会不一致。于是找到了**SDImageCache**类的部分源码，如下：\n\n```\n- (void)storeImage:(UIImage *)image recalculateFromImage:(BOOL)recalculate imageData:(NSData *)imageData forKey:(NSString *)key toDisk:(BOOL)toDisk {\n    if (!image || !key) {\n        return;\n    }\n\n    [self.memCache setObject:image forKey:key cost:image.size.height * image.size.width * image.scale * image.scale];\n\n    if (toDisk) {\n        dispatch_async(self.ioQueue, ^{\n            NSData *data = imageData;\n\n            if (image && (recalculate || !data)) {\n#if TARGET_OS_IPHONE\n                // We need to determine if the image is a PNG or a JPEG\n                // PNGs are easier to detect because they have a unique signature (http://www.w3.org/TR/PNG-Structure.html)\n                // The first eight bytes of a PNG file always contain the following (decimal) values:\n                // 137 80 78 71 13 10 26 10\n\n                // We assume the image is PNG, in case the imageData is nil (i.e. if trying to save a UIImage directly),\n                // we will consider it PNG to avoid loosing the transparency\n                BOOL imageIsPng = YES;\n\n                // But if we have an image data, we will look at the preffix\n                if ([imageData length] >= [kPNGSignatureData length]) {\n                    imageIsPng = ImageDataHasPNGPreffix(imageData);\n                }\n\n                if (imageIsPng) {\n                    data = UIImagePNGRepresentation(image);\n                }\n                else {\n                    data = UIImageJPEGRepresentation(image, (CGFloat)1.0);\n                }\n#else\n                data = [NSBitmapImageRep representationOfImageRepsInArray:image.representations usingType: NSJPEGFileType properties:nil];\n#endif\n            }\n\n            if (data) {\n                if (![_fileManager fileExistsAtPath:_diskCachePath]) {\n                    [_fileManager createDirectoryAtPath:_diskCachePath withIntermediateDirectories:YES attributes:nil error:NULL];\n                }\n\n                [_fileManager createFileAtPath:[self defaultCachePathForKey:key] contents:data attributes:nil];\n            }\n        });\n    }\n}\n\n```\n可以知道**UIImage**对象在IO线程中直接使用**UIImagePNGRepresentation**或者**UIImageJPEGRepresentation**方法转换成**NSData**对象然后直接存储到文件中了。 **imageData**参数可以从以下两个方法知道，默认情况下是传的**nil**值。\n\n```\n- (void)storeImage:(UIImage *)image forKey:(NSString *)key {\n    [self storeImage:image recalculateFromImage:YES imageData:nil forKey:key toDisk:YES];\n}\n\n- (void)storeImage:(UIImage *)image forKey:(NSString *)key toDisk:(BOOL)toDisk {\n    [self storeImage:image recalculateFromImage:YES imageData:nil forKey:key toDisk:toDisk];\n}\n```\n \n也就是说我们在使用**SDImageCache**做缓存时，默认会当做PNG图片存储到文件。而经过测试发现**UIImagePNGRepresentation**方法转换成**NSData**对象时，EXIF信息将会丢失，而**UIImageJPEGRepresentation**方法则不会。在找到原因之后，问题就可以很好的解决了，只要在加入到缓存之前，将图片恢复到正常方向，再将图片保存到缓存中即可。  \n\n### 获取缓存失败\n本以为问题都解决了，然而第二天我们测试发现在一些情况下，插入图片时会显示一张默认图片（图片如果加载失败会显示一张默认的小图），在跟测试MM做了一些沟通之后，走读了一下代码流程，并进行了调试，发现图片被放进缓存之后，再次进行获取时，却获取不到数据。  \n\n想不通为什么，于是看了一下**SDImageCache**类的源码（前面有提到），结合调试发现的一些信息，在加载iPad（我们的应用是iPad）拍摄的照片并且在插入多张图片之后才会出现这种现象，于是猜想是不是在**UIImage**对象在加入到缓存中之后，这时候收到内存警告或者超过设定的阀值，导致被加入的对象在IO线程还未将图片写入到磁盘之前就被释放了，这样将导致从内存和磁盘中都获取不到数据。为了验证这个猜想，修改了**SDImageCache**源码，设置了memCache的delegate，**NSCache**有个delegate，协议如下：\n\n```\n@protocol NSCacheDelegate <NSObject>\n@optional\n- (void)cache:(NSCache *)cache willEvictObject:(id)obj;\n@end\n```\n\n通过该protocol便可以知道被加入缓存中的对象什么时候被释放。在delegate中、IO线程中写入文件成功之后以及获取**UIImage**对象时添加一些Log信息。这样便可以知道各个逻辑的执行流程。经过验证，执行流程我猜想的一样，**UIImage**对象在加入到缓存一小会时间之后立马被释放了，这时候IO线程还未执行完成，这时候从缓存中是获取不到缓存数据的。从而导致失败显示默认图片。  \n\n问题已经找到了，但是要解决这个问题很是蛋疼，分别有以下几种做法：\n* 修改上层逻辑代码等待IO线程写入成功后，才执行后续流程，这样确保一定能获取到数据。\n* 修改**SDWebImage**让内存数据不那么快被释放。\n* 自己重新造个轮子达到我们想要的要求。\n\n对于上述修改第一条有点恶心，有点打补丁的节奏。针对后两条不太实际，工作量太大，最近在[**ibireme**](http://blog.ibireme.com/)的博客上看一个[**YYCache**](https://github.com/ibireme/YYCache)的开源项目，看了介绍还不错，于是将项目中的缓存直接换成了**YYCache**，做了相同的测试，发现问题没有出现了。^o^，后续将阅读一下**YYCache**的源代码了，看看具体的实现方法。\n\n### 总结\n在优化的过程中发现了**SDWebImage**的两个问题分别为：\n* 在使用**SDWebImage**做图片缓存时，图片默认会被当做PNG格式存储，而**UIImagePNGRepresentation**方法转换成**NSData**时会丢失EXIF信息，这样当再次从磁盘读取数据时，将是丢失EXIF信息的图片，从而导致无法进行正常的图片旋转。\n* 使用**SDWebImage**做缓存时，当内存到达一个临界值时，加入的新的缓存对象，会在IO线程写入文件之前释放，在内存对象被释放，IO未完成写入的这段时间内，无法正确获取到缓存数据。  \n\n[**SDWebImage**](https://github.com/rs/SDWebImage)很多人在用，而且使用起来也很方便，尤其在加载网络图片时非常方便，项目中还将继续使用用来做网络图片的加载，不过内存缓存会使用[**YYCache**](https://github.com/ibireme/YYCache)， 针对[**YYCache**](https://github.com/ibireme/YYCache)这个类，还没来得及细看代码，网上评价作者代码相当工整，看过[**YYCategories**](https://github.com/ibireme/YYCategories)部分源码实现，确实写的不错，今后多看看，向大牛们学习。\n\n\n\n\n\n\n\n\n\n","source":"_posts/sdwebimage-issues.md","raw":"title: 优化APP时发现的SDWebImage的问题\ndate: 2015-12-22 19:34:17\ncategories: 开发笔记 \ntags: [SDWebImage, NSCache, 旋转]\n---\n### 起因 旋转了的图片\n前段时间在对程序的绘图逻辑进行了使用OpenGL做优化，但是在使用OpenGL进行绘制时发现一些图片会莫名其妙的旋转，在细看了代码之后发现问题发生在**UIImage**对象的**imageOrientation**属性。该属性为枚举类型可以有以下取值：  \n<!--more-->\n\n```\ntypedef enum {\n    UIImageOrientationUp,            // default orientation  默认方向   \n    UIImageOrientationDown,          // 180 deg rotation     旋转180度    \n    UIImageOrientationLeft,          // 90 deg CCW           逆时针旋转90度\n    UIImageOrientationRight,         // 90 deg CW            顺时针旋转90度\n    UIImageOrientationUpMirrored,    // horizontal flip      向上水平翻转\n    UIImageOrientationDownMirrored,  // horizontal flip      向下水平翻转\n    UIImageOrientationLeftMirrored,  // vertical flip        逆时针旋转90度，垂直翻转\n    UIImageOrientationRightMirrored, // vertical flip        顺时针旋转90度，垂直翻转\n} UIImageOrientation;\n```\n\n该属性用来记录照片的方向信息，在使用iPhone或者iPad自带的照相机拍摄出来的照片含有EXIF信息，而在使用Core Graphics进行绘制时，会进行一些转换，我在使用OpenGL绘制时直接使用的原图，转换成纹理对象时是旋转的图片对象，所以在使用OpenGL绘制会出现旋转问题。在网上找了一下代码做了调整：\n\n```\n- (UIImage *)fixOrientation{\n    \n    // No-op if the orientation is already correct\n    if (self.imageOrientation == UIImageOrientationUp)\n        return self;\n    \n    // We need to calculate the proper transformation to make the image upright.\n    // We do it in 2 steps: Rotate if Left/Right/Down, and then flip if Mirrored.\n    CGAffineTransform transform = CGAffineTransformIdentity;\n    \n    switch (self.imageOrientation) {\n        case UIImageOrientationDown:\n        case UIImageOrientationDownMirrored:\n            transform = CGAffineTransformTranslate(transform, self.size.width, self.size.height);\n            transform = CGAffineTransformRotate(transform, M_PI);\n            break;\n            \n        case UIImageOrientationLeft:\n        case UIImageOrientationLeftMirrored:\n            transform = CGAffineTransformTranslate(transform, self.size.width, 0);\n            transform = CGAffineTransformRotate(transform, M_PI_2);\n            break;\n            \n        case UIImageOrientationRight:\n        case UIImageOrientationRightMirrored:\n            transform = CGAffineTransformTranslate(transform, 0, self.size.height);\n            transform = CGAffineTransformRotate(transform, -M_PI_2);\n            break;\n        default:\n            break;\n    }\n    \n    switch (self.imageOrientation) {\n        case UIImageOrientationUpMirrored:\n        case UIImageOrientationDownMirrored:\n            transform = CGAffineTransformTranslate(transform, self.size.width, 0);\n            transform = CGAffineTransformScale(transform, -1, 1);\n            break;\n            \n        case UIImageOrientationLeftMirrored:\n        case UIImageOrientationRightMirrored:\n            transform = CGAffineTransformTranslate(transform, self.size.height, 0);\n            transform = CGAffineTransformScale(transform, -1, 1);\n            break;\n        default:\n            break;\n    }\n    \n    // Now we draw the underlying CGImage into a new context, applying the transform\n    // calculated above.\n    CGContextRef ctx = CGBitmapContextCreate(NULL, self.size.width, self.size.height,\n                                             CGImageGetBitsPerComponent(self.CGImage), 0,\n                                             CGImageGetColorSpace(self.CGImage),\n                                             CGImageGetBitmapInfo(self.CGImage));\n    CGContextConcatCTM(ctx, transform);\n    switch (self.imageOrientation) {\n        case UIImageOrientationLeft:\n        case UIImageOrientationLeftMirrored:\n        case UIImageOrientationRight:\n        case UIImageOrientationRightMirrored:\n            // Grr...\n            CGContextDrawImage(ctx, CGRectMake(0,0,self.size.height,self.size.width), self.CGImage);\n            break;\n            \n        default:\n            CGContextDrawImage(ctx, CGRectMake(0,0,self.size.width,self.size.height), self.CGImage);\n            break;\n    }\n    \n    // And now we just create a new UIImage from the drawing context\n    CGImageRef cgimg = CGBitmapContextCreateImage(ctx);\n    UIImage *img = [UIImage imageWithCGImage:cgimg];\n    CGContextRelease(ctx);\n    CGImageRelease(cgimg);\n    return img;\n}\n```\n### 再次遇到旋转问题\n\n旋转问题得到解决之后，使用了**SDWebImage**自带的**SDImageCache**类进行了图片的缓存管理，该类能够做到内存不足时释放不需要的图片对象。类底层使用了系统的**NSCache**实现的，能够在系统内存不足时释放被管理的对象。   \n\n在使用**SDImageCache**类做缓存之后，我们的测试MM发现在一些情况下会出现图片旋转的问题。而且是 Core Graphics 和 OpenGL 两个环境下都会出现。因为有了前面的经验，很快就找到了方向，那就是**UIImage**对象的**imageOrientation**属性出问题了，经过一步步调试发现，在**UIImage**对象交给**SDImageCache**管理之后，再从缓存中拿出来时**imageOrientation**属性会不一致。于是找到了**SDImageCache**类的部分源码，如下：\n\n```\n- (void)storeImage:(UIImage *)image recalculateFromImage:(BOOL)recalculate imageData:(NSData *)imageData forKey:(NSString *)key toDisk:(BOOL)toDisk {\n    if (!image || !key) {\n        return;\n    }\n\n    [self.memCache setObject:image forKey:key cost:image.size.height * image.size.width * image.scale * image.scale];\n\n    if (toDisk) {\n        dispatch_async(self.ioQueue, ^{\n            NSData *data = imageData;\n\n            if (image && (recalculate || !data)) {\n#if TARGET_OS_IPHONE\n                // We need to determine if the image is a PNG or a JPEG\n                // PNGs are easier to detect because they have a unique signature (http://www.w3.org/TR/PNG-Structure.html)\n                // The first eight bytes of a PNG file always contain the following (decimal) values:\n                // 137 80 78 71 13 10 26 10\n\n                // We assume the image is PNG, in case the imageData is nil (i.e. if trying to save a UIImage directly),\n                // we will consider it PNG to avoid loosing the transparency\n                BOOL imageIsPng = YES;\n\n                // But if we have an image data, we will look at the preffix\n                if ([imageData length] >= [kPNGSignatureData length]) {\n                    imageIsPng = ImageDataHasPNGPreffix(imageData);\n                }\n\n                if (imageIsPng) {\n                    data = UIImagePNGRepresentation(image);\n                }\n                else {\n                    data = UIImageJPEGRepresentation(image, (CGFloat)1.0);\n                }\n#else\n                data = [NSBitmapImageRep representationOfImageRepsInArray:image.representations usingType: NSJPEGFileType properties:nil];\n#endif\n            }\n\n            if (data) {\n                if (![_fileManager fileExistsAtPath:_diskCachePath]) {\n                    [_fileManager createDirectoryAtPath:_diskCachePath withIntermediateDirectories:YES attributes:nil error:NULL];\n                }\n\n                [_fileManager createFileAtPath:[self defaultCachePathForKey:key] contents:data attributes:nil];\n            }\n        });\n    }\n}\n\n```\n可以知道**UIImage**对象在IO线程中直接使用**UIImagePNGRepresentation**或者**UIImageJPEGRepresentation**方法转换成**NSData**对象然后直接存储到文件中了。 **imageData**参数可以从以下两个方法知道，默认情况下是传的**nil**值。\n\n```\n- (void)storeImage:(UIImage *)image forKey:(NSString *)key {\n    [self storeImage:image recalculateFromImage:YES imageData:nil forKey:key toDisk:YES];\n}\n\n- (void)storeImage:(UIImage *)image forKey:(NSString *)key toDisk:(BOOL)toDisk {\n    [self storeImage:image recalculateFromImage:YES imageData:nil forKey:key toDisk:toDisk];\n}\n```\n \n也就是说我们在使用**SDImageCache**做缓存时，默认会当做PNG图片存储到文件。而经过测试发现**UIImagePNGRepresentation**方法转换成**NSData**对象时，EXIF信息将会丢失，而**UIImageJPEGRepresentation**方法则不会。在找到原因之后，问题就可以很好的解决了，只要在加入到缓存之前，将图片恢复到正常方向，再将图片保存到缓存中即可。  \n\n### 获取缓存失败\n本以为问题都解决了，然而第二天我们测试发现在一些情况下，插入图片时会显示一张默认图片（图片如果加载失败会显示一张默认的小图），在跟测试MM做了一些沟通之后，走读了一下代码流程，并进行了调试，发现图片被放进缓存之后，再次进行获取时，却获取不到数据。  \n\n想不通为什么，于是看了一下**SDImageCache**类的源码（前面有提到），结合调试发现的一些信息，在加载iPad（我们的应用是iPad）拍摄的照片并且在插入多张图片之后才会出现这种现象，于是猜想是不是在**UIImage**对象在加入到缓存中之后，这时候收到内存警告或者超过设定的阀值，导致被加入的对象在IO线程还未将图片写入到磁盘之前就被释放了，这样将导致从内存和磁盘中都获取不到数据。为了验证这个猜想，修改了**SDImageCache**源码，设置了memCache的delegate，**NSCache**有个delegate，协议如下：\n\n```\n@protocol NSCacheDelegate <NSObject>\n@optional\n- (void)cache:(NSCache *)cache willEvictObject:(id)obj;\n@end\n```\n\n通过该protocol便可以知道被加入缓存中的对象什么时候被释放。在delegate中、IO线程中写入文件成功之后以及获取**UIImage**对象时添加一些Log信息。这样便可以知道各个逻辑的执行流程。经过验证，执行流程我猜想的一样，**UIImage**对象在加入到缓存一小会时间之后立马被释放了，这时候IO线程还未执行完成，这时候从缓存中是获取不到缓存数据的。从而导致失败显示默认图片。  \n\n问题已经找到了，但是要解决这个问题很是蛋疼，分别有以下几种做法：\n* 修改上层逻辑代码等待IO线程写入成功后，才执行后续流程，这样确保一定能获取到数据。\n* 修改**SDWebImage**让内存数据不那么快被释放。\n* 自己重新造个轮子达到我们想要的要求。\n\n对于上述修改第一条有点恶心，有点打补丁的节奏。针对后两条不太实际，工作量太大，最近在[**ibireme**](http://blog.ibireme.com/)的博客上看一个[**YYCache**](https://github.com/ibireme/YYCache)的开源项目，看了介绍还不错，于是将项目中的缓存直接换成了**YYCache**，做了相同的测试，发现问题没有出现了。^o^，后续将阅读一下**YYCache**的源代码了，看看具体的实现方法。\n\n### 总结\n在优化的过程中发现了**SDWebImage**的两个问题分别为：\n* 在使用**SDWebImage**做图片缓存时，图片默认会被当做PNG格式存储，而**UIImagePNGRepresentation**方法转换成**NSData**时会丢失EXIF信息，这样当再次从磁盘读取数据时，将是丢失EXIF信息的图片，从而导致无法进行正常的图片旋转。\n* 使用**SDWebImage**做缓存时，当内存到达一个临界值时，加入的新的缓存对象，会在IO线程写入文件之前释放，在内存对象被释放，IO未完成写入的这段时间内，无法正确获取到缓存数据。  \n\n[**SDWebImage**](https://github.com/rs/SDWebImage)很多人在用，而且使用起来也很方便，尤其在加载网络图片时非常方便，项目中还将继续使用用来做网络图片的加载，不过内存缓存会使用[**YYCache**](https://github.com/ibireme/YYCache)， 针对[**YYCache**](https://github.com/ibireme/YYCache)这个类，还没来得及细看代码，网上评价作者代码相当工整，看过[**YYCategories**](https://github.com/ibireme/YYCategories)部分源码实现，确实写的不错，今后多看看，向大牛们学习。\n\n\n\n\n\n\n\n\n\n","slug":"sdwebimage-issues","published":1,"updated":"2016-01-07T02:10:57.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cijflzuv400035m8dpkvyh3vy","sticky":0},{"title":"iOS下使用OpenGL要注意的几点","date":"2015-12-29T08:59:49.000Z","_content":"\n因为项目中使用到了OpenGL ES做绘图，记录一下一些要注意的点：  \n\n* *glGenTextures()*方法申请到的纹理对象ID，会由系统控制其对象的释放（也可以使用*glDeleteTextures()*进行手动释放），所以在使用之前需要使用*glIsTexture()*来检测该纹理ID是否可用，当为false时，需要重新生成纹理对象ID，如果继续使用该纹理ID，会无法绘制从而导致绘制时为纯白色。  \n<!--more-->\n* iOS下不同的硬件设备，最大的纹理大小是有限制的，如下表（来源于网络）：\n\n\n  | 1024 x 1024 | 2048 x 2048 | 4096 x 4096 |\n  |    :--:     |     :--:    |    :--:     |\n  | iPhone 2G   | iPhone 3gs  | iPhone 4s   |\n  | iPhone 3G   | iPhone 4    | iPad 2      |\n  |             | iPad        | iPad 3      |\n\n\n* 我在最新的iPad Air上测试发现最大也支持4096x4096，所以结合上表来看，从iPhone4S和iPad2开始，到最新的iPhone6s以及最新的iPad Air最大也只能支持4096x4096的大小。所以在使用时要注意，否则会导致无法渲染而变成纯白色。  \n* 在使用OpenGL时纹理图片的宽高都需要是2的N次方，在一些平台下（PC平台）下没有这样的限制。并且纹理图片不需要非得是正方形的。所以在使用一些不符合大小时，需要手动对图片进行拉伸，然后复制到显存中进行关联，在进行绘制时按对应的坐标进行转换，所以并不用担心图片在渲染时会被拉伸的问题。\n\n> 我使用的是OpenGL ES 1.x的版本，第一条我在网上没找到太多的资料，都是通过测试发现的，如果有什么不对，还请指正，谢谢。","source":"_posts/ios-xia-opengl-xu-yao-zhu-yi-de-ji-dian.md","raw":"title: iOS下使用OpenGL要注意的几点\ndate: 2015-12-29 16:59:49\ncategories: 开发笔记\ntags: [OpenGL, 纹理]\n---\n\n因为项目中使用到了OpenGL ES做绘图，记录一下一些要注意的点：  \n\n* *glGenTextures()*方法申请到的纹理对象ID，会由系统控制其对象的释放（也可以使用*glDeleteTextures()*进行手动释放），所以在使用之前需要使用*glIsTexture()*来检测该纹理ID是否可用，当为false时，需要重新生成纹理对象ID，如果继续使用该纹理ID，会无法绘制从而导致绘制时为纯白色。  \n<!--more-->\n* iOS下不同的硬件设备，最大的纹理大小是有限制的，如下表（来源于网络）：\n\n\n  | 1024 x 1024 | 2048 x 2048 | 4096 x 4096 |\n  |    :--:     |     :--:    |    :--:     |\n  | iPhone 2G   | iPhone 3gs  | iPhone 4s   |\n  | iPhone 3G   | iPhone 4    | iPad 2      |\n  |             | iPad        | iPad 3      |\n\n\n* 我在最新的iPad Air上测试发现最大也支持4096x4096，所以结合上表来看，从iPhone4S和iPad2开始，到最新的iPhone6s以及最新的iPad Air最大也只能支持4096x4096的大小。所以在使用时要注意，否则会导致无法渲染而变成纯白色。  \n* 在使用OpenGL时纹理图片的宽高都需要是2的N次方，在一些平台下（PC平台）下没有这样的限制。并且纹理图片不需要非得是正方形的。所以在使用一些不符合大小时，需要手动对图片进行拉伸，然后复制到显存中进行关联，在进行绘制时按对应的坐标进行转换，所以并不用担心图片在渲染时会被拉伸的问题。\n\n> 我使用的是OpenGL ES 1.x的版本，第一条我在网上没找到太多的资料，都是通过测试发现的，如果有什么不对，还请指正，谢谢。","slug":"ios-xia-opengl-xu-yao-zhu-yi-de-ji-dian","published":1,"updated":"2016-01-07T02:25:25.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cijflzuvf000c5m8dhtxomydq","sticky":0},{"title":"iOS开发者证书以及代码签名学习笔记","date":"2016-01-15T09:47:06.000Z","_content":"\n> 最近需要给iOS开发团队做一次关于iOS开发证书以及代码签名的分享，于是花了点时间把这一块的知识重新学习和整理了一遍，从而有了这篇学习笔记。其中很多一些文字都是从网站或者博客上摘抄过来，为了阅读方便也做了一些调整，说白了我只是做了一些知识的梳理和整合。  \n\n> 该笔记涉及到内容有：开发者账号、签名证书、标识符（Identifiers）、设备（Devices）、APP授权机制、配置文件、ipa文件的签名和安全验证。\n\n<!--more-->\n\n### 开发者账号类型\n\n苹果为iOS开发者提供三种账号类型，如下：\n\n* **Apple Developer Program** 年费 $99(或¥688) 可以在iOS App Store和Mac App Store上架应用可以以个人（Individual）或者组织（Organization）的名义加入，以组织身份加入需要提供邓白氏编码（DUNS Number），会多出Team Management功能，允许多人协作开发。在发布署名上以组织（Organization）的名义加入可以填写公司或组织信息（比如某某公司、某某工作室），而以个人（Individual）加入只能默认显示注册时填写的个人信息，并且不能修改。\n* **Apple Developer Enterprise Program**年费 $299，用于以InHouse方式发布企业内部应用，不能上架App Store企业证书过期则已经安装的应用无法继续运行。\n* **iOS Developer University Program**\n高校计划需要提供高校基本信息，免费提供。苹果为鼓励高校更多的参与到苹果开发者计划中来，特意推出这一项计划，高校计划具有在真机上测试等权限，但不能将App发布到App Store。\n\n### 证书（Certificates）\n\n什么是证书？证书就是：证明证书拥有者有证书上所说的能力，一个证书要涉及到颁发者、拥有者、证明拥有者有了什么能力。例如，CET-4证书；颁发者：学校，拥有者：自己，证明的能力：英语达到四级水平。苹果开发者证书也是一样，颁发者：自己，拥有者：安装证书的电脑；证明的能力：可以打包某应用程序。  \n\n#### 开发者证书能力来源\n\n向Member Center申请证书的过程，其实就是将在本地生成的`certSigningRequest`文件提交给苹果，让它进行签名授权的过程。`certSigningRequest`这个文件包含以下内容：\n\n1. 申请者信息，此信息是用申请者的私钥加密的。\n2. 申请者公钥，此信息是申请者使用的私钥对应的公钥。\n3. 摘要算法和公钥加密算法。\n\n当苹果用私钥对其签名（授权）之后，我们便可以获得一个证书文件。拥有该证书后，我们便可以用对应的私钥对APP签名了。当iOS设备拿到APP时便可以通过证书中的公钥来验证APP的正确性，同时iOS设备本身可以验证证书的是否被授权，因为该证书是苹果自己签名的证书。\n\n> 被苹果签名的证书会随APP一起打包到ipa文件中，并提交到App store中。\n\n当我们获得签名证书之后，还需要一个证书来验证证书是否被正确授权，该证书就是Worldwide Developer Relations Certificate Authority证书。该证书一般都会随Xcode一起安装到我们的电脑中，也可以从Member Center去下载。所以如果没有该证书，开发者将不能使用对应的私钥对APP的签名，因为不能确保证书是否被授权。该证书也就是网上有提到媒介证书（Intermediate Certificate）。\n\n#### 证书的类型\n\n苹果为开发者提供三种证书类型，用来在不同环境下使用，方便开发者的调试和测试。\n\n* **开发证书**：平时用来进行真机调试的证书，用该证书签名的APP，只能安装在指定的设备上。\n* **测试证书**：不可以用来真机调试的证书，但是可以编译到指定的真机上（不可以进行调试）。主要用来提交给测试进行功能的验证，和**开发证书**的区别在于，它和**发布证书**类似处于非沙盒坏境。但是用该证书签名的APP无法提交到App store，只能安装在指定设备上。  \n* **发布证书**：不可以用来调试和测试，也不能安装在指定设备上，只能提交到App store。\n\n> 使用**企业（Enterprise）**账号下的**发布证书**签名的APP可以安装到所以设备上，但是不能提交到App store。\n\n### 标识符（Identifiers）\n\n在Member Center中，Identifiers可以管理App IDs、Pass Type IDs、Website Push IDs、iCloud Containers、App Groups、Merchant IDs、这里主要介绍App IDs。  \n\nApp ID其实就是一个字符串，用来做APP唯一标识的字符串，App ID是大小写敏感的。一个APP有且只能有一个ID，并且唯一。在Project中称为Bundle ID（但是会有些小差别，Bundle ID不能包含**[ * ]**号）。在Member Center、Project、iTunes Connect都是需要此ID去标示此App的唯一性。App ID添加之后不能进行修改和删除。\n\n#### App ID字符的组成和类型\n\n![](http://www.enkichen.com/uploads/3.png)\n\n如上图所示，App ID由Apple产生的一个Team ID作为前缀，后面跟的是开发者自定义的标识符，App ID字符串中只能包含字符（A-Z，a-z，0-9），连接符（-），点（.）而且此字符串最好是reverse-DNS格式的。例如你公司的域名是cctv.com，你App的名字是Hello，那么你可以用com.cctv.Hello作为你的Bundle ID。\n\nApp ID中也可以以**[ .* ]**来结尾，用来表示一个通配类型，如图：\n\n![](http://www.enkichen.com/uploads/4.png)\n\n* 精准类型的App ID：在标识符中不带**[ .* ]**来结尾的App ID可以称作为精准类型，该类型的App ID可以用来做APP的Bundle ID。\n* 通配符类型App ID：在标识符中以**[ .* ]**结尾的App ID为通配符类型的App ID，该类型的App ID不能用来做APP的Bundle ID，其作用后续会讲到。\n\n> 每个APP还会对应一串数字的字符串（在**itunesconnect**创建之后可以得到），通过该字符串可以向Apple提供的http接口（http://itunes.apple.com/lookup?id=**），获取对应的APP在App store上的信息，可以用来检测版本更新，更新的log一些其他资料。\n\n#### App ID的作用\n\n* 在Xcode工程中，Bundle ID储存在Info.plist中，当你编译工程的时候，他会把此文件拷贝到你的app包中。  \n* 在iTunes Connect，用Bundle ID去标识App，在你第一次构建上传之后，你就不能在改变或者删除你的Bundle ID了。  \n* 在Member Center，你创建一个和Bundle ID相匹配的App ID。如果App ID是精准类型的，你就必须精确的去匹配你的Bundle ID。  \n\n### 授权机制 (Entitlements)\n\n授权机制决定了哪些系统资源在什么情况下允许被一个应用使用。简单的说它就是一个沙盒的配置列表，上面列出了哪些行为被允许，哪些会被拒绝。Xcode 会将这个文件作为`--entitlements`参数的内容传给 **codesign**。\n\n在 Xcode 的 Capabilities 选项卡下选择一些选项之后，Xcode 就会生成这样一段 XML。 Xcode 会自动生成一个 .entitlements 文件，然后在需要的时候往里面添加条目。当构建整个应用时，这个文件也会提交给 **codesign** 作为应用所需要拥有哪些授权的参考。这些授权信息必须都在开发者中心的 App ID 中启用，并且包含在配置文件中。\n\n> 授权列表在Member Center中的**App ID**中配置，这样便可以对应到具体的APP。\n\n### 设备（Devices）\n\n这里的Device指的就是用来测试或者调试用的设备。可以是iPhone、iPad、iPod、Apple watch以及Apple TV，在Member Center中添加测试Device的步骤其实很简单，只要拿到对应Deveice的UDID就可以添加了。我们可以利用iTunes、iTools、Xcode这些工具都可以拿到设备的UDID。\n\n> 需要注意的就是，每个开发者账号，每年最多可以添加100台调试设备，而且添加之后不能更改和删除，想要修改就要等到下一年重新续费的时候才能进行修改或者删除调试设备了。\n\n### 配置文件（Provisioning Profiles）\n\n上述提到了证书可以证明APP的所属以及APP的完整性，保证APP的本身的安全。但是却不能细化到APP所使用的服务被苹果认可，比如APN推送服务，并且证书无法限制调试版APP的装机规模。于是苹果想出了`mobileprovision `。一个`mobileprovision `文件包含一下内容：\n\n1. **AppID** 这里的AppId可以是精准类型的也可以是通配符类型。\n2. **证书列表** 在多人协议开发时，一个`mobileprovision `文件中可以包含多个证书文件。\n3. **功能授权列表**\n4. **可安装的设备列表** 测试和调试`mobileprovision `文件中包含设备列表，`mobileprovision `发布类型的文件中则不包含设备列表。\n5. **苹果的签名**\n\n> 上述提到的**苹果的签名**是用的苹果自己的私钥对应的公钥是Worldwide Developer Relations Certificate Authority证书（媒介证书）中的公钥，所以该文件生成后，我们是不能进行修改的，必须从Member Center中配置并生成。\n\n#### 配置文件的区分\n\n* 从`mobileprovision `文件中是否包含设备列表，可以分为带device信息的描述文件和不带device信息的描述文件如图：\n\n![](http://www.enkichen.com/uploads/1451875454246244.png)  \n\n![](http://www.enkichen.com/uploads/1451875469811263.png) \n\n* 也可以根据配置文件中包含的证书文件的类型来区分：**开发类型**、**测试类型**、**发布类型**。  \n\n* 也可以根据配置文件中包含的App ID来做区分，如果文件中App ID是精准类型的，那么该配置只能用来对指定的APP进行使用。如果是通配类型的，那么该证书可以用来对匹配的Bundle ID的APP进行使用。如果是Company类型的开发者账号，可以生成一个供团队使用的Team Provisioning Profile，通过这个配置文件，团队内成员可以共用一个配置文件来进行开发调试，当然，App ID得指定成通配类型的。`mobileprovision `文件结构如下：\n\n![](http://www.enkichen.com/uploads/5.png)  \n\n总的来说描述文件就是整合了**证书**、**AppID**、**设备**以及**功能授权列表**，从而确定了可由哪台电脑，把哪个App，安装到哪台手机上面。\n\n### APP的签名和安全验证过程\n\n#### ipa文件的签名过程\n\n这张图阐述了，开发iOS应用程序时，从申请证书，到打包的大致过程。\n\n![](http://www.enkichen.com/uploads/iOS证书和校验.png)\n\n#### ipa文件的组成\n\niOS程序最终都会以.ipa文件导出，ipa文件只是一个zip包，可以直接解压，先来了解一下ipa文件的结构：\n\n![](http://www.enkichen.com/uploads/ipa组成.png)\n\n解压后，得到上图的Payload目录，下面是个子目录，其中的内容如下：\n\n* 资源文件，例如图片、html、等等。\n* _CodeSignature/CodeResources。这是一个plist文件，可用文本查看，其中的内容就是是程序包中（不包括Frameworks）所有文件的签名。注意这里是所有文件。意味着你的程序一旦签名，就不能更改其中任何的东西，包括资源文件和可执行文件本身。iOS系统会检查这些签名。\n* 可执行文件。此文件跟资源文件一样需要签名。\n* 一个mobileprovision文件.打包的时候使用的，从MC上生成的。\n* Frameworks。程序引用的非系统自带的Frameworks，每个Frameworks其实就是一个app，其中的结构应该和app差不多，也包含签名信息CodeResources文件。\n\n#### ipa文件的安全验证过程\n\n1. 解压ipa文件\n2. 取出embedded.mobileprovision，通过签名校验是否被篡改过 a. 其中有几个证书的公钥，其中开发证书和发布证书用于校验签名 b. BundleId c. 授权列表\n3. 校验所有文件的签名，包括Frameworks\n4. 比对Info.plist里面的BundleId是否符合embedded.mobileprovision文件中的\n\n### 其他涉及到的问题\n\n* 团队开发证书的管理\n* Xcode7下的免年费的真机调试\n\n### 总结\n\n当加入到苹果开发者计划之后，苹果通过证书来授权给开发者开发iOS应用，并提供了多种证书类型来满足不同的需求。为了保证APP的安全性和完整性，APP中所有的文件都将被签名。除非重新签名，否则不能对其做任何修改。\n\n`mobileprovision`文件是一个配置文件，由苹果签名后发布给开发者的。其中包含了**证书**、**App ID**、**设备列表**、**授权列表**。通过这些信息从而确定了可由哪台电脑，把哪个App，安装到哪台手机上面。所以**证书**和`mobileprovision`文件是签名和打包的两个必要文件。\n\n### 参考资料\n\n* [**不让苹果开发者账号折磨我**](http://www.cocoachina.com/ios/20160104/14859.html)    \n* [**苹果开发者账号那些事儿**](http://ryantang.me/blog/2013/09/03/apple-account-2/)  \n* [**漫谈iOS程序的证书和签名机制**](http://www.pchou.info/ios/2015/12/14/ios-certification-and-code-sign.html)\n* [**代码签名探析**](http://objccn.io/issue-17-2/)\n* [**iOS Code Signing 学习笔记**](http://www.cocoachina.com/ios/20141017/9949.html)\n\n","source":"_posts/ios-certification-and-code-sign-note.md","raw":"title: iOS开发者证书以及代码签名学习笔记\ndate: 2016-01-15 17:47:06\ncategories: 学习笔记\ntags: [开发证书, 代码签名, mobileprovision, Provisioning Profiles, 开发者账号]\n---\n\n> 最近需要给iOS开发团队做一次关于iOS开发证书以及代码签名的分享，于是花了点时间把这一块的知识重新学习和整理了一遍，从而有了这篇学习笔记。其中很多一些文字都是从网站或者博客上摘抄过来，为了阅读方便也做了一些调整，说白了我只是做了一些知识的梳理和整合。  \n\n> 该笔记涉及到内容有：开发者账号、签名证书、标识符（Identifiers）、设备（Devices）、APP授权机制、配置文件、ipa文件的签名和安全验证。\n\n<!--more-->\n\n### 开发者账号类型\n\n苹果为iOS开发者提供三种账号类型，如下：\n\n* **Apple Developer Program** 年费 $99(或¥688) 可以在iOS App Store和Mac App Store上架应用可以以个人（Individual）或者组织（Organization）的名义加入，以组织身份加入需要提供邓白氏编码（DUNS Number），会多出Team Management功能，允许多人协作开发。在发布署名上以组织（Organization）的名义加入可以填写公司或组织信息（比如某某公司、某某工作室），而以个人（Individual）加入只能默认显示注册时填写的个人信息，并且不能修改。\n* **Apple Developer Enterprise Program**年费 $299，用于以InHouse方式发布企业内部应用，不能上架App Store企业证书过期则已经安装的应用无法继续运行。\n* **iOS Developer University Program**\n高校计划需要提供高校基本信息，免费提供。苹果为鼓励高校更多的参与到苹果开发者计划中来，特意推出这一项计划，高校计划具有在真机上测试等权限，但不能将App发布到App Store。\n\n### 证书（Certificates）\n\n什么是证书？证书就是：证明证书拥有者有证书上所说的能力，一个证书要涉及到颁发者、拥有者、证明拥有者有了什么能力。例如，CET-4证书；颁发者：学校，拥有者：自己，证明的能力：英语达到四级水平。苹果开发者证书也是一样，颁发者：自己，拥有者：安装证书的电脑；证明的能力：可以打包某应用程序。  \n\n#### 开发者证书能力来源\n\n向Member Center申请证书的过程，其实就是将在本地生成的`certSigningRequest`文件提交给苹果，让它进行签名授权的过程。`certSigningRequest`这个文件包含以下内容：\n\n1. 申请者信息，此信息是用申请者的私钥加密的。\n2. 申请者公钥，此信息是申请者使用的私钥对应的公钥。\n3. 摘要算法和公钥加密算法。\n\n当苹果用私钥对其签名（授权）之后，我们便可以获得一个证书文件。拥有该证书后，我们便可以用对应的私钥对APP签名了。当iOS设备拿到APP时便可以通过证书中的公钥来验证APP的正确性，同时iOS设备本身可以验证证书的是否被授权，因为该证书是苹果自己签名的证书。\n\n> 被苹果签名的证书会随APP一起打包到ipa文件中，并提交到App store中。\n\n当我们获得签名证书之后，还需要一个证书来验证证书是否被正确授权，该证书就是Worldwide Developer Relations Certificate Authority证书。该证书一般都会随Xcode一起安装到我们的电脑中，也可以从Member Center去下载。所以如果没有该证书，开发者将不能使用对应的私钥对APP的签名，因为不能确保证书是否被授权。该证书也就是网上有提到媒介证书（Intermediate Certificate）。\n\n#### 证书的类型\n\n苹果为开发者提供三种证书类型，用来在不同环境下使用，方便开发者的调试和测试。\n\n* **开发证书**：平时用来进行真机调试的证书，用该证书签名的APP，只能安装在指定的设备上。\n* **测试证书**：不可以用来真机调试的证书，但是可以编译到指定的真机上（不可以进行调试）。主要用来提交给测试进行功能的验证，和**开发证书**的区别在于，它和**发布证书**类似处于非沙盒坏境。但是用该证书签名的APP无法提交到App store，只能安装在指定设备上。  \n* **发布证书**：不可以用来调试和测试，也不能安装在指定设备上，只能提交到App store。\n\n> 使用**企业（Enterprise）**账号下的**发布证书**签名的APP可以安装到所以设备上，但是不能提交到App store。\n\n### 标识符（Identifiers）\n\n在Member Center中，Identifiers可以管理App IDs、Pass Type IDs、Website Push IDs、iCloud Containers、App Groups、Merchant IDs、这里主要介绍App IDs。  \n\nApp ID其实就是一个字符串，用来做APP唯一标识的字符串，App ID是大小写敏感的。一个APP有且只能有一个ID，并且唯一。在Project中称为Bundle ID（但是会有些小差别，Bundle ID不能包含**[ * ]**号）。在Member Center、Project、iTunes Connect都是需要此ID去标示此App的唯一性。App ID添加之后不能进行修改和删除。\n\n#### App ID字符的组成和类型\n\n![](http://www.enkichen.com/uploads/3.png)\n\n如上图所示，App ID由Apple产生的一个Team ID作为前缀，后面跟的是开发者自定义的标识符，App ID字符串中只能包含字符（A-Z，a-z，0-9），连接符（-），点（.）而且此字符串最好是reverse-DNS格式的。例如你公司的域名是cctv.com，你App的名字是Hello，那么你可以用com.cctv.Hello作为你的Bundle ID。\n\nApp ID中也可以以**[ .* ]**来结尾，用来表示一个通配类型，如图：\n\n![](http://www.enkichen.com/uploads/4.png)\n\n* 精准类型的App ID：在标识符中不带**[ .* ]**来结尾的App ID可以称作为精准类型，该类型的App ID可以用来做APP的Bundle ID。\n* 通配符类型App ID：在标识符中以**[ .* ]**结尾的App ID为通配符类型的App ID，该类型的App ID不能用来做APP的Bundle ID，其作用后续会讲到。\n\n> 每个APP还会对应一串数字的字符串（在**itunesconnect**创建之后可以得到），通过该字符串可以向Apple提供的http接口（http://itunes.apple.com/lookup?id=**），获取对应的APP在App store上的信息，可以用来检测版本更新，更新的log一些其他资料。\n\n#### App ID的作用\n\n* 在Xcode工程中，Bundle ID储存在Info.plist中，当你编译工程的时候，他会把此文件拷贝到你的app包中。  \n* 在iTunes Connect，用Bundle ID去标识App，在你第一次构建上传之后，你就不能在改变或者删除你的Bundle ID了。  \n* 在Member Center，你创建一个和Bundle ID相匹配的App ID。如果App ID是精准类型的，你就必须精确的去匹配你的Bundle ID。  \n\n### 授权机制 (Entitlements)\n\n授权机制决定了哪些系统资源在什么情况下允许被一个应用使用。简单的说它就是一个沙盒的配置列表，上面列出了哪些行为被允许，哪些会被拒绝。Xcode 会将这个文件作为`--entitlements`参数的内容传给 **codesign**。\n\n在 Xcode 的 Capabilities 选项卡下选择一些选项之后，Xcode 就会生成这样一段 XML。 Xcode 会自动生成一个 .entitlements 文件，然后在需要的时候往里面添加条目。当构建整个应用时，这个文件也会提交给 **codesign** 作为应用所需要拥有哪些授权的参考。这些授权信息必须都在开发者中心的 App ID 中启用，并且包含在配置文件中。\n\n> 授权列表在Member Center中的**App ID**中配置，这样便可以对应到具体的APP。\n\n### 设备（Devices）\n\n这里的Device指的就是用来测试或者调试用的设备。可以是iPhone、iPad、iPod、Apple watch以及Apple TV，在Member Center中添加测试Device的步骤其实很简单，只要拿到对应Deveice的UDID就可以添加了。我们可以利用iTunes、iTools、Xcode这些工具都可以拿到设备的UDID。\n\n> 需要注意的就是，每个开发者账号，每年最多可以添加100台调试设备，而且添加之后不能更改和删除，想要修改就要等到下一年重新续费的时候才能进行修改或者删除调试设备了。\n\n### 配置文件（Provisioning Profiles）\n\n上述提到了证书可以证明APP的所属以及APP的完整性，保证APP的本身的安全。但是却不能细化到APP所使用的服务被苹果认可，比如APN推送服务，并且证书无法限制调试版APP的装机规模。于是苹果想出了`mobileprovision `。一个`mobileprovision `文件包含一下内容：\n\n1. **AppID** 这里的AppId可以是精准类型的也可以是通配符类型。\n2. **证书列表** 在多人协议开发时，一个`mobileprovision `文件中可以包含多个证书文件。\n3. **功能授权列表**\n4. **可安装的设备列表** 测试和调试`mobileprovision `文件中包含设备列表，`mobileprovision `发布类型的文件中则不包含设备列表。\n5. **苹果的签名**\n\n> 上述提到的**苹果的签名**是用的苹果自己的私钥对应的公钥是Worldwide Developer Relations Certificate Authority证书（媒介证书）中的公钥，所以该文件生成后，我们是不能进行修改的，必须从Member Center中配置并生成。\n\n#### 配置文件的区分\n\n* 从`mobileprovision `文件中是否包含设备列表，可以分为带device信息的描述文件和不带device信息的描述文件如图：\n\n![](http://www.enkichen.com/uploads/1451875454246244.png)  \n\n![](http://www.enkichen.com/uploads/1451875469811263.png) \n\n* 也可以根据配置文件中包含的证书文件的类型来区分：**开发类型**、**测试类型**、**发布类型**。  \n\n* 也可以根据配置文件中包含的App ID来做区分，如果文件中App ID是精准类型的，那么该配置只能用来对指定的APP进行使用。如果是通配类型的，那么该证书可以用来对匹配的Bundle ID的APP进行使用。如果是Company类型的开发者账号，可以生成一个供团队使用的Team Provisioning Profile，通过这个配置文件，团队内成员可以共用一个配置文件来进行开发调试，当然，App ID得指定成通配类型的。`mobileprovision `文件结构如下：\n\n![](http://www.enkichen.com/uploads/5.png)  \n\n总的来说描述文件就是整合了**证书**、**AppID**、**设备**以及**功能授权列表**，从而确定了可由哪台电脑，把哪个App，安装到哪台手机上面。\n\n### APP的签名和安全验证过程\n\n#### ipa文件的签名过程\n\n这张图阐述了，开发iOS应用程序时，从申请证书，到打包的大致过程。\n\n![](http://www.enkichen.com/uploads/iOS证书和校验.png)\n\n#### ipa文件的组成\n\niOS程序最终都会以.ipa文件导出，ipa文件只是一个zip包，可以直接解压，先来了解一下ipa文件的结构：\n\n![](http://www.enkichen.com/uploads/ipa组成.png)\n\n解压后，得到上图的Payload目录，下面是个子目录，其中的内容如下：\n\n* 资源文件，例如图片、html、等等。\n* _CodeSignature/CodeResources。这是一个plist文件，可用文本查看，其中的内容就是是程序包中（不包括Frameworks）所有文件的签名。注意这里是所有文件。意味着你的程序一旦签名，就不能更改其中任何的东西，包括资源文件和可执行文件本身。iOS系统会检查这些签名。\n* 可执行文件。此文件跟资源文件一样需要签名。\n* 一个mobileprovision文件.打包的时候使用的，从MC上生成的。\n* Frameworks。程序引用的非系统自带的Frameworks，每个Frameworks其实就是一个app，其中的结构应该和app差不多，也包含签名信息CodeResources文件。\n\n#### ipa文件的安全验证过程\n\n1. 解压ipa文件\n2. 取出embedded.mobileprovision，通过签名校验是否被篡改过 a. 其中有几个证书的公钥，其中开发证书和发布证书用于校验签名 b. BundleId c. 授权列表\n3. 校验所有文件的签名，包括Frameworks\n4. 比对Info.plist里面的BundleId是否符合embedded.mobileprovision文件中的\n\n### 其他涉及到的问题\n\n* 团队开发证书的管理\n* Xcode7下的免年费的真机调试\n\n### 总结\n\n当加入到苹果开发者计划之后，苹果通过证书来授权给开发者开发iOS应用，并提供了多种证书类型来满足不同的需求。为了保证APP的安全性和完整性，APP中所有的文件都将被签名。除非重新签名，否则不能对其做任何修改。\n\n`mobileprovision`文件是一个配置文件，由苹果签名后发布给开发者的。其中包含了**证书**、**App ID**、**设备列表**、**授权列表**。通过这些信息从而确定了可由哪台电脑，把哪个App，安装到哪台手机上面。所以**证书**和`mobileprovision`文件是签名和打包的两个必要文件。\n\n### 参考资料\n\n* [**不让苹果开发者账号折磨我**](http://www.cocoachina.com/ios/20160104/14859.html)    \n* [**苹果开发者账号那些事儿**](http://ryantang.me/blog/2013/09/03/apple-account-2/)  \n* [**漫谈iOS程序的证书和签名机制**](http://www.pchou.info/ios/2015/12/14/ios-certification-and-code-sign.html)\n* [**代码签名探析**](http://objccn.io/issue-17-2/)\n* [**iOS Code Signing 学习笔记**](http://www.cocoachina.com/ios/20141017/9949.html)\n\n","slug":"ios-certification-and-code-sign-note","published":1,"updated":"2016-01-15T11:35:23.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cijflzuvj000i5m8dtegjir27","sticky":0},{"title":"无法旋转的UIWindow子类","date":"2016-01-05T02:36:34.000Z","_content":"\n项目中一直用了两个**UIWindow**，一个是框架默认的，另一个是用来显示调试信息的**UIWindow**。至于为什么要用一个**UIWindow**，而不是用**UIView**呢，是因为**UIView**旋转控制太麻烦了，如果用**UIView**加一个**UIViewController**会方便很多，而且也不用考虑系统版本的区别。  \n<!--more-->\n最近一个同事用同样的方法使用**UIWindow**子类做一个提示框的公用组件，但发现`rootViewController`无法自动旋转。于是我对比了两个**UIWindow**的子类，发现代码并没什么区别，只是多了一些公用方法和一个`delegate`。但就是不能支持旋转，而我的都正常，试过好多方法，都没找到原因。最后只好一部分一部分注释掉一些代码。当我把一个`delegate`的属性注释掉以后，神奇的事情发生了，竟然可以旋转了！！！！ 于是把所有改动都还原了，然后只注释掉`delegate`属性（改一个名称也一样），发现旋转一切正常了。于是在我之前的**UIWindow**子类中添加`delegate`属性，发现也不能进行旋转。  \n\n猜想是不是子类`delegate`属性覆盖了父类的`delegate`属性，而**UIWindow**在控制旋转的逻辑跟`delegate`属性有关。至少有一下两种方式进行调试：  \n\n* 子类**UIWindow**中添加`delegate`属性，然后在setDelegate方法中添加日志。\n* 使用Category为**UIWindow**添加一个`delegate`属性声明，然后打印`delegate`属性\n\n通过上述方法可以发现，**UIWindow**内部实现是存在一个`delegate`属性的，根据日志可以确定该属性是指向`rootViewController`对象。也就是说如果我们在**UIWindow**子类添加`delegate`属性就会影响到**UIWindow**对旋转的控制。  \n\n后续调试发现旋转的相关方法在`rootViewController`中都会正常被调用，但就是没办法进行旋转，也就是说在**UIWindow**子类中添加`delegate`属性和没有添加该属性，对应我们应用来说，该走的方法都会按照正常流程跑完，但就是不能进行旋转。具体原因还未知，后续有新发现将会更新，如果有人知道，还请告知，谢谢，以下我的调试环境：  \n\n> OSX版本为：10.10.5 (14F27)  \n> Xcode 版本为：7.2 (7C68)   \n> SDK：iOS 9.2  \n","source":"_posts/UIWindow-cannot-rotate.md","raw":"title: 无法旋转的UIWindow子类\ndate: 2016-01-05 10:36:34\ncategories: 开发笔记\ntags: [UIWindow, 旋转]\n---\n\n项目中一直用了两个**UIWindow**，一个是框架默认的，另一个是用来显示调试信息的**UIWindow**。至于为什么要用一个**UIWindow**，而不是用**UIView**呢，是因为**UIView**旋转控制太麻烦了，如果用**UIView**加一个**UIViewController**会方便很多，而且也不用考虑系统版本的区别。  \n<!--more-->\n最近一个同事用同样的方法使用**UIWindow**子类做一个提示框的公用组件，但发现`rootViewController`无法自动旋转。于是我对比了两个**UIWindow**的子类，发现代码并没什么区别，只是多了一些公用方法和一个`delegate`。但就是不能支持旋转，而我的都正常，试过好多方法，都没找到原因。最后只好一部分一部分注释掉一些代码。当我把一个`delegate`的属性注释掉以后，神奇的事情发生了，竟然可以旋转了！！！！ 于是把所有改动都还原了，然后只注释掉`delegate`属性（改一个名称也一样），发现旋转一切正常了。于是在我之前的**UIWindow**子类中添加`delegate`属性，发现也不能进行旋转。  \n\n猜想是不是子类`delegate`属性覆盖了父类的`delegate`属性，而**UIWindow**在控制旋转的逻辑跟`delegate`属性有关。至少有一下两种方式进行调试：  \n\n* 子类**UIWindow**中添加`delegate`属性，然后在setDelegate方法中添加日志。\n* 使用Category为**UIWindow**添加一个`delegate`属性声明，然后打印`delegate`属性\n\n通过上述方法可以发现，**UIWindow**内部实现是存在一个`delegate`属性的，根据日志可以确定该属性是指向`rootViewController`对象。也就是说如果我们在**UIWindow**子类添加`delegate`属性就会影响到**UIWindow**对旋转的控制。  \n\n后续调试发现旋转的相关方法在`rootViewController`中都会正常被调用，但就是没办法进行旋转，也就是说在**UIWindow**子类中添加`delegate`属性和没有添加该属性，对应我们应用来说，该走的方法都会按照正常流程跑完，但就是不能进行旋转。具体原因还未知，后续有新发现将会更新，如果有人知道，还请告知，谢谢，以下我的调试环境：  \n\n> OSX版本为：10.10.5 (14F27)  \n> Xcode 版本为：7.2 (7C68)   \n> SDK：iOS 9.2  \n","slug":"UIWindow-cannot-rotate","published":1,"updated":"2016-01-07T02:08:00.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cijflzuvo000v5m8dbf96g5ob","sticky":0},{"title":"开博第一篇","date":"2015-12-19T01:02:51.000Z","_content":"折腾了几天总算把博客搭建成功了，心情大好，本博客是基于[**GitHub**](https://github.com/)和[**Hexo**](https://hexo.io/)搭建，并使用了[**NexT.Mist**](https://github.com/iissnan/hexo-theme-next)主题，在万网购买的域名，两个域名分别为[**www.enkichen.com**](http://www.enkichen.com)和[**www.enkichen.cn**](http://www.enkichen.cn)，5年400多点大洋，个人觉得还是蛮便宜的。希望今后在这里记录我的成长和收获，同时也为了多年之后看看当初幼稚的自己。","source":"_posts/First-blog.md","raw":"title: 开博第一篇\ndate: 2015-12-19 09:02:51\ncategories: default\ntags: \n---\n折腾了几天总算把博客搭建成功了，心情大好，本博客是基于[**GitHub**](https://github.com/)和[**Hexo**](https://hexo.io/)搭建，并使用了[**NexT.Mist**](https://github.com/iissnan/hexo-theme-next)主题，在万网购买的域名，两个域名分别为[**www.enkichen.com**](http://www.enkichen.com)和[**www.enkichen.cn**](http://www.enkichen.cn)，5年400多点大洋，个人觉得还是蛮便宜的。希望今后在这里记录我的成长和收获，同时也为了多年之后看看当初幼稚的自己。","slug":"First-blog","published":1,"updated":"2015-12-19T03:51:47.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cijflzuvr00105m8dxxk197jr","sticky":0}],"PostAsset":[],"PostCategory":[{"post_id":"cijflzuv400035m8dpkvyh3vy","category_id":"cijflzuv800045m8denoh1sx3","_id":"cijflzuvb00075m8dqjtslpx2"},{"post_id":"cijflzuvf000c5m8dhtxomydq","category_id":"cijflzuv800045m8denoh1sx3","_id":"cijflzuvh000d5m8dok8spl5e"},{"post_id":"cijflzuvj000i5m8dtegjir27","category_id":"cijflzuvl000j5m8dl00ejuvb","_id":"cijflzuvm000m5m8d81i4ohxw"},{"post_id":"cijflzuvo000v5m8dbf96g5ob","category_id":"cijflzuv800045m8denoh1sx3","_id":"cijflzuvp000w5m8dcjgcquoa"},{"post_id":"cijflzuvr00105m8dxxk197jr","category_id":"cijflzuvs00115m8dktqi9lx3","_id":"cijflzuvs00125m8dhjzz89fw"}],"PostTag":[{"post_id":"cijflzuv400035m8dpkvyh3vy","tag_id":"cijflzuv900055m8d1j8oeuud","_id":"cijflzuvd00095m8dj5ox2uxt"},{"post_id":"cijflzuv400035m8dpkvyh3vy","tag_id":"cijflzuvb00065m8ditv0je2y","_id":"cijflzuvd000a5m8d4i101ovw"},{"post_id":"cijflzuv400035m8dpkvyh3vy","tag_id":"cijflzuvc00085m8d0h08hnu0","_id":"cijflzuvd000b5m8duae7cusc"},{"post_id":"cijflzuvf000c5m8dhtxomydq","tag_id":"cijflzuvh000e5m8d37wqnep3","_id":"cijflzuvh000g5m8drasbm527"},{"post_id":"cijflzuvf000c5m8dhtxomydq","tag_id":"cijflzuvh000f5m8djhizn4xm","_id":"cijflzuvi000h5m8dr9xtrzj6"},{"post_id":"cijflzuvj000i5m8dtegjir27","tag_id":"cijflzuvl000k5m8dbsj62dtl","_id":"cijflzuvn000q5m8dkeof0jzg"},{"post_id":"cijflzuvj000i5m8dtegjir27","tag_id":"cijflzuvm000l5m8dtgj2xqpq","_id":"cijflzuvn000r5m8d0txa963d"},{"post_id":"cijflzuvj000i5m8dtegjir27","tag_id":"cijflzuvm000n5m8dep1wd4mk","_id":"cijflzuvn000s5m8d8ppzicno"},{"post_id":"cijflzuvj000i5m8dtegjir27","tag_id":"cijflzuvm000o5m8d3x07odmc","_id":"cijflzuvn000t5m8d52howrva"},{"post_id":"cijflzuvj000i5m8dtegjir27","tag_id":"cijflzuvm000p5m8deg8inu0h","_id":"cijflzuvn000u5m8da6c1hy8d"},{"post_id":"cijflzuvo000v5m8dbf96g5ob","tag_id":"cijflzuvq000x5m8dbbmkw8l7","_id":"cijflzuvq000y5m8d3bqgsqrn"},{"post_id":"cijflzuvo000v5m8dbf96g5ob","tag_id":"cijflzuvc00085m8d0h08hnu0","_id":"cijflzuvq000z5m8dqrk58tpe"}],"Tag":[{"name":"SDWebImage","_id":"cijflzuv900055m8d1j8oeuud"},{"name":"NSCache","_id":"cijflzuvb00065m8ditv0je2y"},{"name":"旋转","_id":"cijflzuvc00085m8d0h08hnu0"},{"name":"OpenGL","_id":"cijflzuvh000e5m8d37wqnep3"},{"name":"纹理","_id":"cijflzuvh000f5m8djhizn4xm"},{"name":"开发证书","_id":"cijflzuvl000k5m8dbsj62dtl"},{"name":"代码签名","_id":"cijflzuvm000l5m8dtgj2xqpq"},{"name":"mobileprovision","_id":"cijflzuvm000n5m8dep1wd4mk"},{"name":"Provisioning Profiles","_id":"cijflzuvm000o5m8d3x07odmc"},{"name":"开发者账号","_id":"cijflzuvm000p5m8deg8inu0h"},{"name":"UIWindow","_id":"cijflzuvq000x5m8dbbmkw8l7"}]}}